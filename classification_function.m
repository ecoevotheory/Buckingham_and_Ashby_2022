function [classJ,classA]=classification_function(a0,g0,c1a,c2a,c1g,c2g,beta0,f,h,alpha,resJval,resAval,version,initvec,orig_tmax)
  
% This function determines whether a co-singular strategy (resJval,
% resAval) is an evolutionary repeller (class=2), a CSS (class=1) or a
% branching point (class=3). It uses the analytical conditions for
% evolutionary and strong convergence stability, in terms of the second
% derivatives of the fitness functions. 

eps=1e-2;

% Define trade-offs at the singular strategy and slightly above and below
% it:
if version==1
    aval=a0*(1-c1a*(1-exp(-c2a*resAval))/(1-exp(-c2a)));
    gval=g0*(1-c1g*(1-exp(-c2g*resJval))/(1-exp(-c2g)));
    bJval=1;
    bAval=1;
    
    avalupJ=a0*(1-c1a*(1-exp(-c2a*resAval))/(1-exp(-c2a)));
    gvalupJ=g0*(1-c1g*(1-exp(-c2g*(resJval+eps)))/(1-exp(-c2g)));
    bJvalupJ=1;
    bAvalupJ=1;
    
    avaldownJ=a0*(1-c1a*(1-exp(-c2a*resAval))/(1-exp(-c2a)));
    gvaldownJ=g0*(1-c1g*(1-exp(-c2g*(resJval-eps)))/(1-exp(-c2g)));
    bJvaldownJ=1;
    bAvaldownJ=1;
    
    avalupA=a0*(1-c1a*(1-exp(-c2a*(resAval+eps)))/(1-exp(-c2a)));
    gvalupA=g0*(1-c1g*(1-exp(-c2g*(resJval)))/(1-exp(-c2g)));
    bJvalupA=1;
    bAvalupA=1;
    
    avaldownA=a0*(1-c1a*(1-exp(-c2a*(resAval-eps)))/(1-exp(-c2a)));
    gvaldownA=g0*(1-c1g*(1-exp(-c2g*(resJval)))/(1-exp(-c2g)));
    bJvaldownA=1;
    bAvaldownA=1;
    
elseif version==2
    bJval=1+c1g*(1-exp(-c2g*resJval))/(1-exp(-c2g));
    bAval=1+c1a*(1-exp(-c2a*resAval))/(1-exp(-c2a));
    aval=a0;
    gval=g0;
    
    avalupJ=a0;
    gvalupJ=g0;
    bJvalupJ=1+c1g*(1-exp(-c2g*(resJval+eps)))/(1-exp(-c2g));
    bAvalupJ=1+c1a*(1-exp(-c2a*resAval))/(1-exp(-c2a));
    
    avaldownJ=a0;
    gvaldownJ=g0;
    bJvaldownJ=1+c1g*(1-exp(-c2g*(resJval-eps)))/(1-exp(-c2g));
    bAvaldownJ=1+c1a*(1-exp(-c2a*resAval))/(1-exp(-c2a));
    
    avalupA=a0;
    gvalupA=g0;
    bJvalupA=1+c1g*(1-exp(-c2g*(resJval)))/(1-exp(-c2g));
    bAvalupA=1+c1a*(1-exp(-c2a*(resAval+eps)))/(1-exp(-c2a));
    
    avaldownA=a0;
    gvaldownA=g0;
    bJvaldownA=1+c1g*(1-exp(-c2g*(resJval)))/(1-exp(-c2g));
    bAvaldownA=1+c1a*(1-exp(-c2a*(resAval-eps)))/(1-exp(-c2a));
    
elseif version==3
    bAval=1+c1a*(1-exp(-c2a*resAval))/(1-exp(-c2a));
    aval=a0*(1-c1g*(1-exp(-c2g*resJval))/(1-exp(-c2g)));
    gval=g0;
    bJval=1;
    
    avalupJ=a0*(1-c1g*(1-exp(-c2g*(resJval+eps)))/(1-exp(-c2g)));
    gvalupJ=g0;
    bJvalupJ=1;
    bAvalupJ=1+c1a*(1-exp(-c2a*resAval))/(1-exp(-c2a));
    
    avaldownJ=a0*(1-c1g*(1-exp(-c2g*(resJval-eps)))/(1-exp(-c2g)));
    gvaldownJ=g0;
    bJvaldownJ=1;
    bAvaldownJ=1+c1a*(1-exp(-c2a*resAval))/(1-exp(-c2a));
    
    avalupA=a0*(1-c1g*(1-exp(-c2g*(resJval)))/(1-exp(-c2g)));
    gvalupA=g0;
    bJvalupA=1;
    bAvalupA=1+c1a*(1-exp(-c2a*(resAval+eps)))/(1-exp(-c2a));
    
    avaldownA=a0*(1-c1g*(1-exp(-c2g*(resJval)))/(1-exp(-c2g)));
    gvaldownA=g0;
    bJvaldownA=1;
    bAvaldownA=1+c1a*(1-exp(-c2a*(resAval-eps)))/(1-exp(-c2a));
    
elseif version==4
    gval=g0*(1-c1g*(1-exp(-c2g*resJval))/(1-exp(-c2g)));
    bAval=1+c1a*(1-exp(-c2a*resAval))/(1-exp(-c2a));
    aval=a0;
    bJval=1;
    
    avalupJ=a0;
    gvalupJ=g0*(1-c1g*(1-exp(-c2g*(resJval+eps)))/(1-exp(-c2g)));
    bJvalupJ=1;
    bAvalupJ=1+c1a*(1-exp(-c2a*resAval))/(1-exp(-c2a));
    
    avaldownJ=a0;
    gvaldownJ=g0*(1-c1g*(1-exp(-c2g*(resJval-eps)))/(1-exp(-c2g)));
    bJvaldownJ=1;
    bAvaldownJ=1+c1a*(1-exp(-c2a*resAval))/(1-exp(-c2a));
    
    avalupA=a0;
    gvalupA=g0*(1-c1g*(1-exp(-c2g*(resJval)))/(1-exp(-c2g)));
    bJvalupA=1;
    bAvalupA=1+c1a*(1-exp(-c2a*(resAval+eps)))/(1-exp(-c2a));
    
    avaldownA=a0;
    gvaldownA=g0*(1-c1g*(1-exp(-c2g*(resJval)))/(1-exp(-c2g)));
    bJvaldownA=1;
    bAvaldownA=1+c1a*(1-exp(-c2a*(resAval-eps)))/(1-exp(-c2a));
    
elseif version==5
    bJval=1+c1g*(1-exp(-c2g*resJval))/(1-exp(-c2g));
    aval=a0*(1-c1a*(1-exp(-c2a*resAval))/(1-exp(-c2a)));
    bAval=1;
    gval=g0;
    
    avalupJ=a0*(1-c1a*(1-exp(-c2a*resAval))/(1-exp(-c2a)));
    gvalupJ=g0;
    bJvalupJ=1+c1g*(1-exp(-c2g*(resJval+eps)))/(1-exp(-c2g));
    bAvalupJ=1;
    
    avaldownJ=a0*(1-c1a*(1-exp(-c2a*resAval))/(1-exp(-c2a)));
    gvaldownJ=g0;
    bJvaldownJ=1+c1g*(1-exp(-c2g*(resJval-eps)))/(1-exp(-c2g));
    bAvaldownJ=1;
    
    avalupA=a0*(1-c1a*(1-exp(-c2a*(resAval+eps)))/(1-exp(-c2a)));
    gvalupA=g0;
    bJvalupA=1+c1g*(1-exp(-c2g*(resJval)))/(1-exp(-c2g));
    bAvalupA=1;
    
    avaldownA=a0*(1-c1a*(1-exp(-c2a*(resAval-eps)))/(1-exp(-c2a)));
    gvaldownA=g0;
    bJvaldownA=1+c1g*(1-exp(-c2g*(resJval)))/(1-exp(-c2g));
    bAvaldownA=1;
    
elseif version==6
    aval=a0*(1-c1a*(1-exp(-c2a*resAval))/(1-exp(-c2a)))*(1-c1g*(1-exp(-c2g*resJval))/(1-exp(-c2g)));
    gval=g0;
    bJval=1;
    bAval=1;
    
    avalupJ=a0*(1-c1a*(1-exp(-c2a*resAval))/(1-exp(-c2a)))*(1-c1g*(1-exp(-c2g*(resJval+eps)))/(1-exp(-c2g)));
    gvalupJ=g0;
    bJvalupJ=1;
    bAvalupJ=1;
    
    avaldownJ=a0*(1-c1a*(1-exp(-c2a*resAval))/(1-exp(-c2a)))*(1-c1g*(1-exp(-c2g*(resJval-eps)))/(1-exp(-c2g)));
    gvaldownJ=g0;
    bJvaldownJ=1;
    bAvaldownJ=1;
    
    avalupA=a0*(1-c1a*(1-exp(-c2a*(resAval+eps)))/(1-exp(-c2a)))*(1-c1g*(1-exp(-c2g*(resJval)))/(1-exp(-c2g)));
    gvalupA=g0;
    bJvalupA=1;
    bAvalupA=1;
    
    avaldownA=a0*(1-c1a*(1-exp(-c2a*(resAval-eps)))/(1-exp(-c2a)))*(1-c1g*(1-exp(-c2g*(resJval)))/(1-exp(-c2g)));
    gvaldownA=g0;
    bJvaldownA=1;
    bAvaldownA=1;
    
end

% Find the endemic equilibrium at the singular strategy and slightly above
% and below it:
[SJval,SAval,IJval,IAval,~]=endemic_equilibrium_function(resJval,resAval,aval,gval,bJval,bAval,beta0,h,f,alpha,initvec,orig_tmax);
[SJupJ,SAupJ,IJupJ,IAupJ,~]=endemic_equilibrium_function(resJval+eps,resAval,avalupJ,gvalupJ,bJvalupJ,bAvalupJ,beta0,h,f,alpha,initvec,orig_tmax);
[SJdownJ,SAdownJ,IJdownJ,IAdownJ,~]=endemic_equilibrium_function(resJval-eps,resAval,avaldownJ,gvaldownJ,bJvaldownJ,bAvaldownJ,beta0,h,f,alpha,initvec,orig_tmax);
[SJupA,SAupA,IJupA,IAupA,~]=endemic_equilibrium_function(resJval,resAval+eps,avalupA,gvalupA,bJvalupA,bAvalupA,beta0,h,f,alpha,initvec,orig_tmax);
[SJdownA,SAdownA,IJdownA,IAdownA,~]=endemic_equilibrium_function(resJval,resAval-eps,avaldownA,gvaldownA,bJvaldownA,bAvaldownA,beta0,h,f,alpha,initvec,orig_tmax);


% Estimate the second derivatives of the fitness functions:
if version==1
    deriv2J=(a0*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*((c1g*c2g^2*g0*exp(-c2g*resJval)*(alpha + 1))/(exp(-c2g) - 1) - (beta0*c1g*c2g^2*f*g0*exp(-c2g*resJval)*(IAval + IJval*h)*(resAval - 1))/(exp(-c2g) - 1))*(IAval + IJval + SAval + SJval - 1))/((beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(alpha + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAval + IJval*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) - (2*a0*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*(IAval + IJval*h) - (c1g*c2g*g0*exp(-c2g*resJval))/(exp(-c2g) - 1))^2*((alpha + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) - beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(IAval + IJval*h)*(resJval - 1))*(IAval + IJval + SAval + SJval - 1))/((beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(alpha + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAval + IJval*h)*(resJval - 1) - 1)^3*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) + (2*a0*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*(IAval + IJval*h) - (c1g*c2g*g0*exp(-c2g*resJval))/(exp(-c2g) - 1))*(beta0*f*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(IAval + IJval*h) + (c1g*c2g*g0*exp(-c2g*resJval)*(alpha + 1))/(exp(-c2g) - 1) - (beta0*c1g*c2g*f*g0*exp(-c2g*resJval)*(IAval + IJval*h)*(resAval - 1))/(exp(-c2g) - 1))*(IAval + IJval + SAval + SJval - 1))/((beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(alpha + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAval + IJval*h)*(resJval - 1) - 1)^2*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) + (2*a0*c1g*c2g*g0*exp(-c2g*resJval)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*(beta0*f*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(IAval + IJval*h) + (c1g*c2g*g0*exp(-c2g*resJval)*(alpha + 1))/(exp(-c2g) - 1) - (beta0*c1g*c2g*f*g0*exp(-c2g*resJval)*(IAval + IJval*h)*(resAval - 1))/(exp(-c2g) - 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2g) - 1)*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(alpha + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAval + IJval*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) - (2*a0*c1g^2*c2g^2*g0^2*exp(-2*c2g*resJval)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((alpha + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) - beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(IAval + IJval*h)*(resJval - 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2g) - 1)^2*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(alpha + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAval + IJval*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)^2) - (a0*c1g*c2g^2*g0*exp(-c2g*resJval)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((alpha + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) - beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(IAval + IJval*h)*(resJval - 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2g) - 1)*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(alpha + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAval + IJval*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) - (a0*c1g*c2g^2*g0^2*exp(-c2g*resJval)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*((alpha + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) - beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(IAval + IJval*h)*(resJval - 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2g) - 1)*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(alpha + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAval + IJval*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)^2) + (a0*c1g*c2g^2*g0^2*exp(-c2g*resJval)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*((alpha + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) - beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(IAval + IJval*h)*(resJval - 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2g) - 1)*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(alpha + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAval + IJval*h)*(resJval - 1) - 1)^2*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) + (2*a0*c1g*c2g*g0^2*exp(-c2g*resJval)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*f*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(IAval + IJval*h) + (c1g*c2g*g0*exp(-c2g*resJval)*(alpha + 1))/(exp(-c2g) - 1) - (beta0*c1g*c2g*f*g0*exp(-c2g*resJval)*(IAval + IJval*h)*(resAval - 1))/(exp(-c2g) - 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2g) - 1)*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(alpha + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAval + IJval*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)^2) - (2*a0*c1g*c2g*g0*exp(-c2g*resJval)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*(beta0*(IAval + IJval*h) - (c1g*c2g*g0*exp(-c2g*resJval))/(exp(-c2g) - 1))*((alpha + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) - beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(IAval + IJval*h)*(resJval - 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2g) - 1)*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(alpha + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAval + IJval*h)*(resJval - 1) - 1)^2*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) - (2*a0*c1g^2*c2g^2*g0^3*exp(-2*c2g*resJval)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*((alpha + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) - beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(IAval + IJval*h)*(resJval - 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2g) - 1)^2*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(alpha + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAval + IJval*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)^3) - (2*a0*c1g*c2g*g0^2*exp(-c2g*resJval)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*(IAval + IJval*h) - (c1g*c2g*g0*exp(-c2g*resJval))/(exp(-c2g) - 1))*((alpha + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) - beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(IAval + IJval*h)*(resJval - 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2g) - 1)*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(alpha + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAval + IJval*h)*(resJval - 1) - 1)^2*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)^2);
    deriv2A=-(2*a0*beta0*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*f*(IAval + IJval*h)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) - beta0^2*f*(IAval + IJval*h)^2*(resJval - 1))*(IAval + IJval*h)*(IAval + IJval + SAval + SJval - 1))/((beta0*(IAval + IJval*h)*(resAval - 1) - 1)^2*(alpha + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAval + IJval*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) - (2*a0*beta0^2*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(IAval + IJval*h)^2*((alpha + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) - beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(IAval + IJval*h)*(resJval - 1))*(IAval + IJval + SAval + SJval - 1))/((beta0*(IAval + IJval*h)*(resAval - 1) - 1)^3*(alpha + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAval + IJval*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) - (2*a0*c1a*c2a*g0*exp(-c2a*resAval)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*f*(IAval + IJval*h)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) - beta0^2*f*(IAval + IJval*h)^2*(resJval - 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2a) - 1)*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(alpha + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAval + IJval*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) - (a0*c1a*c2a^2*g0*exp(-c2a*resAval)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*((alpha + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) - beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(IAval + IJval*h)*(resJval - 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2a) - 1)*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(alpha + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAval + IJval*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) - (2*a0*beta0*c1a*c2a*g0*exp(-c2a*resAval)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(IAval + IJval*h)*((alpha + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) - beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(IAval + IJval*h)*(resJval - 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2a) - 1)*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)^2*(alpha + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAval + IJval*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1));
    
    cderivJ1=((a0*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*f*(beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) - 1)*(IAdownJ + IJdownJ*h) + (c1g*c2g*g0*exp(-c2g*resJval)*(alpha + 1))/(exp(-c2g) - 1) - (beta0*c1g*c2g*f*g0*exp(-c2g*resJval)*(IAdownJ + IJdownJ*h)*(resAval - 1))/(exp(-c2g) - 1))*(IAdownJ + IJdownJ + SAdownJ + SJdownJ - 1))/((beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) - 1)*(alpha + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAdownJ + IJdownJ*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) - (a0*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*f*(beta0*(IAupJ + IJupJ*h)*(resAval - 1) - 1)*(IAupJ + IJupJ*h) + (c1g*c2g*g0*exp(-c2g*resJval)*(alpha + 1))/(exp(-c2g) - 1) - (beta0*c1g*c2g*f*g0*exp(-c2g*resJval)*(IAupJ + IJupJ*h)*(resAval - 1))/(exp(-c2g) - 1))*(IAupJ + IJupJ + SAupJ + SJupJ - 1))/((beta0*(IAupJ + IJupJ*h)*(resAval - 1) - 1)*(alpha + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAupJ + IJupJ*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) - (a0*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*(IAdownJ + IJdownJ*h) - (c1g*c2g*g0*exp(-c2g*resJval))/(exp(-c2g) - 1))*((alpha + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) - beta0*f*(IAdownJ + IJdownJ*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) - 1)*(IAdownJ + IJdownJ*h)*(resJval - 1))*(IAdownJ + IJdownJ + SAdownJ + SJdownJ - 1))/((beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) - 1)*(alpha + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAdownJ + IJdownJ*h)*(resJval - 1) - 1)^2*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) + (a0*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*(IAupJ + IJupJ*h) - (c1g*c2g*g0*exp(-c2g*resJval))/(exp(-c2g) - 1))*((alpha + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) - beta0*f*(IAupJ + IJupJ*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(beta0*(IAupJ + IJupJ*h)*(resAval - 1) - 1)*(IAupJ + IJupJ*h)*(resJval - 1))*(IAupJ + IJupJ + SAupJ + SJupJ - 1))/((beta0*(IAupJ + IJupJ*h)*(resAval - 1) - 1)*(alpha + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAupJ + IJupJ*h)*(resJval - 1) - 1)^2*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) - (a0*c1g*c2g*g0*exp(-c2g*resJval)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((alpha + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) - beta0*f*(IAdownJ + IJdownJ*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) - 1)*(IAdownJ + IJdownJ*h)*(resJval - 1))*(IAdownJ + IJdownJ + SAdownJ + SJdownJ - 1))/((exp(-c2g) - 1)*(beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) - 1)*(alpha + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAdownJ + IJdownJ*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) + (a0*c1g*c2g*g0*exp(-c2g*resJval)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((alpha + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) - beta0*f*(IAupJ + IJupJ*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(beta0*(IAupJ + IJupJ*h)*(resAval - 1) - 1)*(IAupJ + IJupJ*h)*(resJval - 1))*(IAupJ + IJupJ + SAupJ + SJupJ - 1))/((exp(-c2g) - 1)*(beta0*(IAupJ + IJupJ*h)*(resAval - 1) - 1)*(alpha + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAupJ + IJupJ*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) - (a0*c1g*c2g*g0^2*exp(-c2g*resJval)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*((alpha + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) - beta0*f*(IAdownJ + IJdownJ*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) - 1)*(IAdownJ + IJdownJ*h)*(resJval - 1))*(IAdownJ + IJdownJ + SAdownJ + SJdownJ - 1))/((exp(-c2g) - 1)*(beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) - 1)*(alpha + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAdownJ + IJdownJ*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)^2) + (a0*c1g*c2g*g0^2*exp(-c2g*resJval)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*((alpha + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) - beta0*f*(IAupJ + IJupJ*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(beta0*(IAupJ + IJupJ*h)*(resAval - 1) - 1)*(IAupJ + IJupJ*h)*(resJval - 1))*(IAupJ + IJupJ + SAupJ + SJupJ - 1))/((exp(-c2g) - 1)*(beta0*(IAupJ + IJupJ*h)*(resAval - 1) - 1)*(alpha + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAupJ + IJupJ*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)^2))/(2*eps);
    cderivJ2=((a0*g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*((c1a*(exp(-c2a*(eps + resAval)) - 1))/(exp(-c2a) - 1) - 1)*(beta0*(IAupA + IJupA*h) - (c1g*c2g*g0*exp(-c2g*resJval))/(exp(-c2g) - 1))*((alpha + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) - beta0*f*(IAupA + IJupA*h)*(eps + resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(beta0*(IAupA + IJupA*h)*(eps + resAval - 1) - 1)*(IAupA + IJupA*h)*(resJval - 1))*(IAupA + IJupA + SAupA + SJupA - 1))/((beta0*(IAupA + IJupA*h)*(eps + resAval - 1) - 1)*(alpha + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAupA + IJupA*h)*(resJval - 1) - 1)^2*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) - (a0*g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*((c1a*(exp(-c2a*(eps + resAval)) - 1))/(exp(-c2a) - 1) - 1)*(beta0*f*(beta0*(IAupA + IJupA*h)*(eps + resAval - 1) - 1)*(IAupA + IJupA*h) + (c1g*c2g*g0*exp(-c2g*resJval)*(alpha + 1))/(exp(-c2g) - 1) - (beta0*c1g*c2g*f*g0*exp(-c2g*resJval)*(IAupA + IJupA*h)*(eps + resAval - 1))/(exp(-c2g) - 1))*(IAupA + IJupA + SAupA + SJupA - 1))/((beta0*(IAupA + IJupA*h)*(eps + resAval - 1) - 1)*(alpha + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAupA + IJupA*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) - (a0*g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*((c1a*(exp(c2a*(eps - resAval)) - 1))/(exp(-c2a) - 1) - 1)*((c1g*c2g*g0*exp(-c2g*resJval)*(alpha + 1))/(exp(-c2g) - 1) - beta0*f*(beta0*(IAdownA + IJdownA*h)*(eps - resAval + 1) + 1)*(IAdownA + IJdownA*h) + (beta0*c1g*c2g*f*g0*exp(-c2g*resJval)*(IAdownA + IJdownA*h)*(eps - resAval + 1))/(exp(-c2g) - 1))*(IAdownA + IJdownA + SAdownA + SJdownA - 1))/((beta0*(IAdownA + IJdownA*h)*(eps - resAval + 1) + 1)*(alpha + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAdownA + IJdownA*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) + (a0*g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*((c1a*(exp(c2a*(eps - resAval)) - 1))/(exp(-c2a) - 1) - 1)*(beta0*(IAdownA + IJdownA*h) - (c1g*c2g*g0*exp(-c2g*resJval))/(exp(-c2g) - 1))*((alpha + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(IAdownA + IJdownA*h)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)*(eps - resAval + 1) - beta0*f*(beta0*(IAdownA + IJdownA*h)*(eps - resAval + 1) + 1)*(IAdownA + IJdownA*h)*(resJval - 1))*(IAdownA + IJdownA + SAdownA + SJdownA - 1))/((beta0*(IAdownA + IJdownA*h)*(eps - resAval + 1) + 1)*(alpha + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAdownA + IJdownA*h)*(resJval - 1) - 1)^2*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) + (a0*c1g*c2g*g0*exp(-c2g*resJval)*((c1a*(exp(c2a*(eps - resAval)) - 1))/(exp(-c2a) - 1) - 1)*((alpha + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(IAdownA + IJdownA*h)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)*(eps - resAval + 1) - beta0*f*(beta0*(IAdownA + IJdownA*h)*(eps - resAval + 1) + 1)*(IAdownA + IJdownA*h)*(resJval - 1))*(IAdownA + IJdownA + SAdownA + SJdownA - 1))/((beta0*(IAdownA + IJdownA*h)*(eps - resAval + 1) + 1)*(exp(-c2g) - 1)*(alpha + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAdownA + IJdownA*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) + (a0*c1g*c2g*g0*exp(-c2g*resJval)*((c1a*(exp(-c2a*(eps + resAval)) - 1))/(exp(-c2a) - 1) - 1)*((alpha + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) - beta0*f*(IAupA + IJupA*h)*(eps + resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(beta0*(IAupA + IJupA*h)*(eps + resAval - 1) - 1)*(IAupA + IJupA*h)*(resJval - 1))*(IAupA + IJupA + SAupA + SJupA - 1))/((beta0*(IAupA + IJupA*h)*(eps + resAval - 1) - 1)*(exp(-c2g) - 1)*(alpha + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAupA + IJupA*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) + (a0*c1g*c2g*g0^2*exp(-c2g*resJval)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*((c1a*(exp(c2a*(eps - resAval)) - 1))/(exp(-c2a) - 1) - 1)*((alpha + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(IAdownA + IJdownA*h)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)*(eps - resAval + 1) - beta0*f*(beta0*(IAdownA + IJdownA*h)*(eps - resAval + 1) + 1)*(IAdownA + IJdownA*h)*(resJval - 1))*(IAdownA + IJdownA + SAdownA + SJdownA - 1))/((beta0*(IAdownA + IJdownA*h)*(eps - resAval + 1) + 1)*(exp(-c2g) - 1)*(alpha + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAdownA + IJdownA*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)^2) + (a0*c1g*c2g*g0^2*exp(-c2g*resJval)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*((c1a*(exp(-c2a*(eps + resAval)) - 1))/(exp(-c2a) - 1) - 1)*((alpha + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) - beta0*f*(IAupA + IJupA*h)*(eps + resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(beta0*(IAupA + IJupA*h)*(eps + resAval - 1) - 1)*(IAupA + IJupA*h)*(resJval - 1))*(IAupA + IJupA + SAupA + SJupA - 1))/((beta0*(IAupA + IJupA*h)*(eps + resAval - 1) - 1)*(exp(-c2g) - 1)*(alpha + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAupA + IJupA*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)^2))/(2*eps);
    cderivA1=-((a0*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*f*(IAdownA + IJdownA*h)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) - beta0^2*f*(IAdownA + IJdownA*h)^2*(resJval - 1))*(IAdownA + IJdownA + SAdownA + SJdownA - 1))/((beta0*(IAdownA + IJdownA*h)*(resAval - 1) - 1)*(alpha + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAdownA + IJdownA*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) - (a0*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*f*(IAupA + IJupA*h)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) - beta0^2*f*(IAupA + IJupA*h)^2*(resJval - 1))*(IAupA + IJupA + SAupA + SJupA - 1))/((beta0*(IAupA + IJupA*h)*(resAval - 1) - 1)*(alpha + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAupA + IJupA*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) + (a0*beta0*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(IAdownA + IJdownA*h)*((alpha + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) - beta0*f*(IAdownA + IJdownA*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(beta0*(IAdownA + IJdownA*h)*(resAval - 1) - 1)*(IAdownA + IJdownA*h)*(resJval - 1))*(IAdownA + IJdownA + SAdownA + SJdownA - 1))/((beta0*(IAdownA + IJdownA*h)*(resAval - 1) - 1)^2*(alpha + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAdownA + IJdownA*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) - (a0*beta0*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(IAupA + IJupA*h)*((alpha + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) - beta0*f*(IAupA + IJupA*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(beta0*(IAupA + IJupA*h)*(resAval - 1) - 1)*(IAupA + IJupA*h)*(resJval - 1))*(IAupA + IJupA + SAupA + SJupA - 1))/((beta0*(IAupA + IJupA*h)*(resAval - 1) - 1)^2*(alpha + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAupA + IJupA*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) + (a0*c1a*c2a*g0*exp(-c2a*resAval)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*((alpha + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) - beta0*f*(IAdownA + IJdownA*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(beta0*(IAdownA + IJdownA*h)*(resAval - 1) - 1)*(IAdownA + IJdownA*h)*(resJval - 1))*(IAdownA + IJdownA + SAdownA + SJdownA - 1))/((exp(-c2a) - 1)*(beta0*(IAdownA + IJdownA*h)*(resAval - 1) - 1)*(alpha + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAdownA + IJdownA*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) - (a0*c1a*c2a*g0*exp(-c2a*resAval)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*((alpha + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) - beta0*f*(IAupA + IJupA*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(beta0*(IAupA + IJupA*h)*(resAval - 1) - 1)*(IAupA + IJupA*h)*(resJval - 1))*(IAupA + IJupA + SAupA + SJupA - 1))/((exp(-c2a) - 1)*(beta0*(IAupA + IJupA*h)*(resAval - 1) - 1)*(alpha + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAupA + IJupA*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)))/(2*eps);
    cderivA2=((a0*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*(beta0^2*f*(IAdownJ + IJdownJ*h)^2*(eps - resJval + 1) + beta0*f*(IAdownJ + IJdownJ*h)*(alpha - g0*((c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) - 1) + 1))*((c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) - 1)*(IAdownJ + IJdownJ + SAdownJ + SJdownJ - 1))/((beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) - 1)*(alpha + 1)*(beta0*(IAdownJ + IJdownJ*h)*(eps - resJval + 1) - g0*((c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) - 1) + 1)*(alpha - g0*((c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) - 1) + 1)) + (a0*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*(beta0*f*(IAupJ + IJupJ*h)*(alpha - g0*((c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) - 1) + 1) - beta0^2*f*(IAupJ + IJupJ*h)^2*(eps + resJval - 1))*((c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) - 1)*(IAupJ + IJupJ + SAupJ + SJupJ - 1))/((beta0*(IAupJ + IJupJ*h)*(resAval - 1) - 1)*(alpha + 1)*(alpha - g0*((c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) - 1) + 1)*(g0*((c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAupJ + IJupJ*h)*(eps + resJval - 1) - 1)) + (a0*beta0*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*(IAupJ + IJupJ*h)*((c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) - 1)*((alpha + 1)*(alpha - g0*((c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) - 1) + 1) - beta0*f*(IAupJ + IJupJ*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(beta0*(IAupJ + IJupJ*h)*(resAval - 1) - 1)*(IAupJ + IJupJ*h)*(eps + resJval - 1))*(IAupJ + IJupJ + SAupJ + SJupJ - 1))/((beta0*(IAupJ + IJupJ*h)*(resAval - 1) - 1)^2*(alpha + 1)*(alpha - g0*((c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) - 1) + 1)*(g0*((c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAupJ + IJupJ*h)*(eps + resJval - 1) - 1)) - (a0*beta0*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) - 1)*(IAdownJ + IJdownJ*h)*(beta0*f*(beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) - 1)*(IAdownJ + IJdownJ*h)*(eps - resJval + 1) - (alpha + 1)*(alpha - g0*((c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(IAdownJ + IJdownJ*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) - 1) + 1))*(IAdownJ + IJdownJ + SAdownJ + SJdownJ - 1))/((beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) - 1)^2*(alpha + 1)*(beta0*(IAdownJ + IJdownJ*h)*(eps - resJval + 1) - g0*((c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) - 1) + 1)*(alpha - g0*((c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) - 1) + 1)) + (a0*c1a*c2a*g0*exp(-c2a*resAval)*((c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) - 1)*((alpha + 1)*(alpha - g0*((c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) - 1) + 1) - beta0*f*(IAupJ + IJupJ*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(beta0*(IAupJ + IJupJ*h)*(resAval - 1) - 1)*(IAupJ + IJupJ*h)*(eps + resJval - 1))*(IAupJ + IJupJ + SAupJ + SJupJ - 1))/((exp(-c2a) - 1)*(beta0*(IAupJ + IJupJ*h)*(resAval - 1) - 1)*(alpha + 1)*(alpha - g0*((c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) - 1) + 1)*(g0*((c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAupJ + IJupJ*h)*(eps + resJval - 1) - 1)) - (a0*c1a*c2a*g0*exp(-c2a*resAval)*((c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) - 1)*(beta0*f*(beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) - 1)*(IAdownJ + IJdownJ*h)*(eps - resJval + 1) - (alpha + 1)*(alpha - g0*((c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(IAdownJ + IJdownJ*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) - 1) + 1))*(IAdownJ + IJdownJ + SAdownJ + SJdownJ - 1))/((exp(-c2a) - 1)*(beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) - 1)*(alpha + 1)*(beta0*(IAdownJ + IJdownJ*h)*(eps - resJval + 1) - g0*((c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) - 1) + 1)*(alpha - g0*((c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) - 1) + 1)))/(2*eps);
    
elseif version==2
    deriv2J=(2*a0*g0*(beta0*(IAval + IJval*h) + (c1g*c2g*exp(-c2g*resJval))/(exp(-c2g) - 1))*(beta0*f*(IAval + IJval*h)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1) + (c1g*c2g*exp(-c2g*resJval)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1))/(exp(-c2g) - 1) - (beta0*c1g*c2g*f*exp(-c2g*resJval)*(IAval + IJval*h)*(resAval - 1))/(exp(-c2g) - 1))*(IAval + IJval + SAval + SJval - 1))/(((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0 - beta0*(IAval + IJval*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)^2*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)) - (a0*g0*((c1g*c2g^2*exp(-c2g*resJval)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1))/(exp(-c2g) - 1) - (beta0*c1g*c2g^2*f*exp(-c2g*resJval)*(IAval + IJval*h)*(resAval - 1))/(exp(-c2g) - 1))*(IAval + IJval + SAval + SJval - 1))/(((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0 - beta0*(IAval + IJval*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)) + (2*a0*g0*(beta0*(IAval + IJval*h) + (c1g*c2g*exp(-c2g*resJval))/(exp(-c2g) - 1))^2*(beta0*f*(IAval + IJval*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1) - (alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))*(IAval + IJval + SAval + SJval - 1))/(((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0 - beta0*(IAval + IJval*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)^3*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)) + (2*a0*c1g*c2g*g0*exp(-c2g*resJval)*(beta0*f*(IAval + IJval*h)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1) + (c1g*c2g*exp(-c2g*resJval)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1))/(exp(-c2g) - 1) - (beta0*c1g*c2g*f*exp(-c2g*resJval)*(IAval + IJval*h)*(resAval - 1))/(exp(-c2g) - 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2g) - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0 - beta0*(IAval + IJval*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)^2) - (a0*c1g*c2g^2*g0*exp(-c2g*resJval)*(beta0*f*(IAval + IJval*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1) - (alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2g) - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0 - beta0*(IAval + IJval*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)^2) - (a0*c1g*c2g^2*g0*exp(-c2g*resJval)*(beta0*f*(IAval + IJval*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1) - (alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2g) - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0 - beta0*(IAval + IJval*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)^2*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)) + (2*a0*c1g^2*c2g^2*g0*exp(-2*c2g*resJval)*(beta0*f*(IAval + IJval*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1) - (alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2g) - 1)^2*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0 - beta0*(IAval + IJval*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)^3) + (2*a0*c1g*c2g*g0*exp(-c2g*resJval)*(beta0*(IAval + IJval*h) + (c1g*c2g*exp(-c2g*resJval))/(exp(-c2g) - 1))*(beta0*f*(IAval + IJval*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1) - (alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2g) - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0 - beta0*(IAval + IJval*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)^2*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)^2);
    deriv2A=(2*a0*g0*(beta0*(IAval + IJval*h) + (c1a*c2a*exp(-c2a*resAval))/(exp(-c2a) - 1))*(beta0*f*(IAval + IJval*h)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) - beta0*f*(beta0*(IAval + IJval*h) + (c1a*c2a*exp(-c2a*resAval))/(exp(-c2a) - 1))*(IAval + IJval*h)*(resJval - 1) + (c1a*c2a*exp(-c2a*resAval)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))/(exp(-c2a) - 1))*(IAval + IJval + SAval + SJval - 1))/(((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1)^2*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0 - beta0*(IAval + IJval*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)) - (a0*g0*((c1a*c2a^2*exp(-c2a*resAval)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))/(exp(-c2a) - 1) - (beta0*c1a*c2a^2*f*exp(-c2a*resAval)*(IAval + IJval*h)*(resJval - 1))/(exp(-c2a) - 1))*(IAval + IJval + SAval + SJval - 1))/(((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0 - beta0*(IAval + IJval*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)) + (2*a0*g0*(beta0*(IAval + IJval*h) + (c1a*c2a*exp(-c2a*resAval))/(exp(-c2a) - 1))^2*(beta0*f*(IAval + IJval*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1) - (alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))*(IAval + IJval + SAval + SJval - 1))/(((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1)^3*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0 - beta0*(IAval + IJval*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)) + (2*a0*c1a*c2a*g0*exp(-c2a*resAval)*(beta0*f*(IAval + IJval*h)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) - beta0*f*(beta0*(IAval + IJval*h) + (c1a*c2a*exp(-c2a*resAval))/(exp(-c2a) - 1))*(IAval + IJval*h)*(resJval - 1) + (c1a*c2a*exp(-c2a*resAval)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))/(exp(-c2a) - 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2a) - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)^2*(g0 - beta0*(IAval + IJval*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)) - (a0*c1a*c2a^2*g0*exp(-c2a*resAval)*(beta0*f*(IAval + IJval*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1) - (alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2a) - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)^2*(g0 - beta0*(IAval + IJval*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)) - (a0*c1a*c2a^2*g0*exp(-c2a*resAval)*(beta0*f*(IAval + IJval*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1) - (alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2a) - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1)^2*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0 - beta0*(IAval + IJval*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)) + (2*a0*c1a^2*c2a^2*g0*exp(-2*c2a*resAval)*(beta0*f*(IAval + IJval*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1) - (alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2a) - 1)^2*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)^3*(g0 - beta0*(IAval + IJval*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)) + (2*a0*c1a*c2a*g0*exp(-c2a*resAval)*(beta0*(IAval + IJval*h) + (c1a*c2a*exp(-c2a*resAval))/(exp(-c2a) - 1))*(beta0*f*(IAval + IJval*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1) - (alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2a) - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1)^2*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)^2*(g0 - beta0*(IAval + IJval*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1));
    
    cderivJ1=-((a0*g0*(beta0*f*(IAdownJ + IJdownJ*h)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) + 1) + (c1g*c2g*exp(-c2g*resJval)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1))/(exp(-c2g) - 1) - (beta0*c1g*c2g*f*exp(-c2g*resJval)*(IAdownJ + IJdownJ*h)*(resAval - 1))/(exp(-c2g) - 1))*(IAdownJ + IJdownJ + SAdownJ + SJdownJ - 1))/(((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0 - beta0*(IAdownJ + IJdownJ*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)) - (a0*g0*(beta0*f*(IAupJ + IJupJ*h)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupJ + IJupJ*h)*(resAval - 1) + 1) + (c1g*c2g*exp(-c2g*resJval)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1))/(exp(-c2g) - 1) - (beta0*c1g*c2g*f*exp(-c2g*resJval)*(IAupJ + IJupJ*h)*(resAval - 1))/(exp(-c2g) - 1))*(IAupJ + IJupJ + SAupJ + SJupJ - 1))/(((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupJ + IJupJ*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0 - beta0*(IAupJ + IJupJ*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)) + (a0*g0*(beta0*(IAdownJ + IJdownJ*h) + (c1g*c2g*exp(-c2g*resJval))/(exp(-c2g) - 1))*(beta0*f*(IAdownJ + IJdownJ*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) + 1) - (alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(IAdownJ + IJdownJ*h)*(resAval - 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))*(IAdownJ + IJdownJ + SAdownJ + SJdownJ - 1))/(((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0 - beta0*(IAdownJ + IJdownJ*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)^2*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)) - (a0*g0*(beta0*(IAupJ + IJupJ*h) + (c1g*c2g*exp(-c2g*resJval))/(exp(-c2g) - 1))*(beta0*f*(IAupJ + IJupJ*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupJ + IJupJ*h)*(resAval - 1) + 1) - (alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(IAupJ + IJupJ*h)*(resAval - 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))*(IAupJ + IJupJ + SAupJ + SJupJ - 1))/(((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupJ + IJupJ*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0 - beta0*(IAupJ + IJupJ*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)^2*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)) + (a0*c1g*c2g*g0*exp(-c2g*resJval)*(beta0*f*(IAdownJ + IJdownJ*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) + 1) - (alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(IAdownJ + IJdownJ*h)*(resAval - 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))*(IAdownJ + IJdownJ + SAdownJ + SJdownJ - 1))/((exp(-c2g) - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0 - beta0*(IAdownJ + IJdownJ*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)^2) - (a0*c1g*c2g*g0*exp(-c2g*resJval)*(beta0*f*(IAupJ + IJupJ*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupJ + IJupJ*h)*(resAval - 1) + 1) - (alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(IAupJ + IJupJ*h)*(resAval - 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))*(IAupJ + IJupJ + SAupJ + SJupJ - 1))/((exp(-c2g) - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupJ + IJupJ*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0 - beta0*(IAupJ + IJupJ*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)^2))/(2*eps);
    cderivJ2=((a0*g0*(beta0*f*(IAupA + IJupA*h)*((c1a*(exp(-c2a*(eps + resAval)) - 1))/(exp(-c2a) - 1) - beta0*(IAupA + IJupA*h)*(eps + resAval - 1) + 1) + (c1g*c2g*exp(-c2g*resJval)*(alpha + (c1a*(exp(-c2a*(eps + resAval)) - 1))/(exp(-c2a) - 1) + 1))/(exp(-c2g) - 1) - (beta0*c1g*c2g*f*exp(-c2g*resJval)*(IAupA + IJupA*h)*(eps + resAval - 1))/(exp(-c2g) - 1))*(IAupA + IJupA + SAupA + SJupA - 1))/((alpha + (c1a*(exp(-c2a*(eps + resAval)) - 1))/(exp(-c2a) - 1) + 1)*((c1a*(exp(-c2a*(eps + resAval)) - 1))/(exp(-c2a) - 1) - beta0*(IAupA + IJupA*h)*(eps + resAval - 1) + 1)*(g0 - beta0*(IAupA + IJupA*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)) - (a0*g0*(beta0*f*(IAdownA + IJdownA*h)*(beta0*(IAdownA + IJdownA*h)*(eps - resAval + 1) + (c1a*(exp(c2a*(eps - resAval)) - 1))/(exp(-c2a) - 1) + 1) + (c1g*c2g*exp(-c2g*resJval)*(alpha + (c1a*(exp(c2a*(eps - resAval)) - 1))/(exp(-c2a) - 1) + 1))/(exp(-c2g) - 1) + (beta0*c1g*c2g*f*exp(-c2g*resJval)*(IAdownA + IJdownA*h)*(eps - resAval + 1))/(exp(-c2g) - 1))*(IAdownA + IJdownA + SAdownA + SJdownA - 1))/((beta0*(IAdownA + IJdownA*h)*(eps - resAval + 1) + (c1a*(exp(c2a*(eps - resAval)) - 1))/(exp(-c2a) - 1) + 1)*(alpha + (c1a*(exp(c2a*(eps - resAval)) - 1))/(exp(-c2a) - 1) + 1)*(g0 - beta0*(IAdownA + IJdownA*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)) + (a0*g0*(beta0*(IAdownA + IJdownA*h) + (c1g*c2g*exp(-c2g*resJval))/(exp(-c2g) - 1))*((alpha + (c1a*(exp(c2a*(eps - resAval)) - 1))/(exp(-c2a) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(IAdownA + IJdownA*h)*(eps - resAval + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) - beta0*f*(IAdownA + IJdownA*h)*(resJval - 1)*(beta0*(IAdownA + IJdownA*h)*(eps - resAval + 1) + (c1a*(exp(c2a*(eps - resAval)) - 1))/(exp(-c2a) - 1) + 1))*(IAdownA + IJdownA + SAdownA + SJdownA - 1))/((beta0*(IAdownA + IJdownA*h)*(eps - resAval + 1) + (c1a*(exp(c2a*(eps - resAval)) - 1))/(exp(-c2a) - 1) + 1)*(alpha + (c1a*(exp(c2a*(eps - resAval)) - 1))/(exp(-c2a) - 1) + 1)*(g0 - beta0*(IAdownA + IJdownA*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)^2*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)) + (a0*g0*(beta0*(IAupA + IJupA*h) + (c1g*c2g*exp(-c2g*resJval))/(exp(-c2g) - 1))*(beta0*f*(IAupA + IJupA*h)*(resJval - 1)*((c1a*(exp(-c2a*(eps + resAval)) - 1))/(exp(-c2a) - 1) - beta0*(IAupA + IJupA*h)*(eps + resAval - 1) + 1) - (alpha + (c1a*(exp(-c2a*(eps + resAval)) - 1))/(exp(-c2a) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(IAupA + IJupA*h)*(eps + resAval - 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))*(IAupA + IJupA + SAupA + SJupA - 1))/((alpha + (c1a*(exp(-c2a*(eps + resAval)) - 1))/(exp(-c2a) - 1) + 1)*((c1a*(exp(-c2a*(eps + resAval)) - 1))/(exp(-c2a) - 1) - beta0*(IAupA + IJupA*h)*(eps + resAval - 1) + 1)*(g0 - beta0*(IAupA + IJupA*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)^2*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)) + (a0*c1g*c2g*g0*exp(-c2g*resJval)*((alpha + (c1a*(exp(c2a*(eps - resAval)) - 1))/(exp(-c2a) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(IAdownA + IJdownA*h)*(eps - resAval + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) - beta0*f*(IAdownA + IJdownA*h)*(resJval - 1)*(beta0*(IAdownA + IJdownA*h)*(eps - resAval + 1) + (c1a*(exp(c2a*(eps - resAval)) - 1))/(exp(-c2a) - 1) + 1))*(IAdownA + IJdownA + SAdownA + SJdownA - 1))/((exp(-c2g) - 1)*(beta0*(IAdownA + IJdownA*h)*(eps - resAval + 1) + (c1a*(exp(c2a*(eps - resAval)) - 1))/(exp(-c2a) - 1) + 1)*(alpha + (c1a*(exp(c2a*(eps - resAval)) - 1))/(exp(-c2a) - 1) + 1)*(g0 - beta0*(IAdownA + IJdownA*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)^2) + (a0*c1g*c2g*g0*exp(-c2g*resJval)*(beta0*f*(IAupA + IJupA*h)*(resJval - 1)*((c1a*(exp(-c2a*(eps + resAval)) - 1))/(exp(-c2a) - 1) - beta0*(IAupA + IJupA*h)*(eps + resAval - 1) + 1) - (alpha + (c1a*(exp(-c2a*(eps + resAval)) - 1))/(exp(-c2a) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(IAupA + IJupA*h)*(eps + resAval - 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))*(IAupA + IJupA + SAupA + SJupA - 1))/((exp(-c2g) - 1)*(alpha + (c1a*(exp(-c2a*(eps + resAval)) - 1))/(exp(-c2a) - 1) + 1)*((c1a*(exp(-c2a*(eps + resAval)) - 1))/(exp(-c2a) - 1) - beta0*(IAupA + IJupA*h)*(eps + resAval - 1) + 1)*(g0 - beta0*(IAupA + IJupA*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)^2))/(2*eps);
    cderivA1=-((a0*g0*(beta0*f*(IAdownA + IJdownA*h)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) - beta0*f*(beta0*(IAdownA + IJdownA*h) + (c1a*c2a*exp(-c2a*resAval))/(exp(-c2a) - 1))*(IAdownA + IJdownA*h)*(resJval - 1) + (c1a*c2a*exp(-c2a*resAval)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))/(exp(-c2a) - 1))*(IAdownA + IJdownA + SAdownA + SJdownA - 1))/(((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownA + IJdownA*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0 - beta0*(IAdownA + IJdownA*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)) - (a0*g0*(beta0*f*(IAupA + IJupA*h)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) - beta0*f*(beta0*(IAupA + IJupA*h) + (c1a*c2a*exp(-c2a*resAval))/(exp(-c2a) - 1))*(IAupA + IJupA*h)*(resJval - 1) + (c1a*c2a*exp(-c2a*resAval)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))/(exp(-c2a) - 1))*(IAupA + IJupA + SAupA + SJupA - 1))/(((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupA + IJupA*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0 - beta0*(IAupA + IJupA*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)) + (a0*g0*(beta0*(IAdownA + IJdownA*h) + (c1a*c2a*exp(-c2a*resAval))/(exp(-c2a) - 1))*(beta0*f*(IAdownA + IJdownA*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownA + IJdownA*h)*(resAval - 1) + 1) - (alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(IAdownA + IJdownA*h)*(resAval - 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))*(IAdownA + IJdownA + SAdownA + SJdownA - 1))/(((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownA + IJdownA*h)*(resAval - 1) + 1)^2*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0 - beta0*(IAdownA + IJdownA*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)) - (a0*g0*(beta0*(IAupA + IJupA*h) + (c1a*c2a*exp(-c2a*resAval))/(exp(-c2a) - 1))*(beta0*f*(IAupA + IJupA*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupA + IJupA*h)*(resAval - 1) + 1) - (alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(IAupA + IJupA*h)*(resAval - 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))*(IAupA + IJupA + SAupA + SJupA - 1))/(((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupA + IJupA*h)*(resAval - 1) + 1)^2*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0 - beta0*(IAupA + IJupA*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)) + (a0*c1a*c2a*g0*exp(-c2a*resAval)*(beta0*f*(IAdownA + IJdownA*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownA + IJdownA*h)*(resAval - 1) + 1) - (alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(IAdownA + IJdownA*h)*(resAval - 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))*(IAdownA + IJdownA + SAdownA + SJdownA - 1))/((exp(-c2a) - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownA + IJdownA*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)^2*(g0 - beta0*(IAdownA + IJdownA*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)) - (a0*c1a*c2a*g0*exp(-c2a*resAval)*(beta0*f*(IAupA + IJupA*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupA + IJupA*h)*(resAval - 1) + 1) - (alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(IAupA + IJupA*h)*(resAval - 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))*(IAupA + IJupA + SAupA + SJupA - 1))/((exp(-c2a) - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupA + IJupA*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)^2*(g0 - beta0*(IAupA + IJupA*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)))/(2*eps);
    cderivA2=((a0*g0*(beta0*f*(IAupJ + IJupJ*h)*(alpha + g0 + (c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) + 1) + (c1a*c2a*exp(-c2a*resAval)*(alpha + g0 + (c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) + 1))/(exp(-c2a) - 1) - beta0*f*(beta0*(IAupJ + IJupJ*h) + (c1a*c2a*exp(-c2a*resAval))/(exp(-c2a) - 1))*(IAupJ + IJupJ*h)*(eps + resJval - 1))*(IAupJ + IJupJ + SAupJ + SJupJ - 1))/(((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupJ + IJupJ*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) + 1)*(g0 + (c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) - beta0*(IAupJ + IJupJ*h)*(eps + resJval - 1) + 1)) - (a0*g0*(beta0*f*(IAdownJ + IJdownJ*h)*(alpha + g0 + (c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) + 1) + (c1a*c2a*exp(-c2a*resAval)*(alpha + g0 + (c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) + 1))/(exp(-c2a) - 1) + beta0*f*(beta0*(IAdownJ + IJdownJ*h) + (c1a*c2a*exp(-c2a*resAval))/(exp(-c2a) - 1))*(IAdownJ + IJdownJ*h)*(eps - resJval + 1))*(IAdownJ + IJdownJ + SAdownJ + SJdownJ - 1))/(((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0 + beta0*(IAdownJ + IJdownJ*h)*(eps - resJval + 1) + (c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) + 1)) + (a0*g0*(beta0*(IAupJ + IJupJ*h) + (c1a*c2a*exp(-c2a*resAval))/(exp(-c2a) - 1))*(beta0*f*(IAupJ + IJupJ*h)*(resAval - 1)*(alpha + g0 + (c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) + 1) - (alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(IAupJ + IJupJ*h)*(eps + resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupJ + IJupJ*h)*(resAval - 1) + 1))*(IAupJ + IJupJ + SAupJ + SJupJ - 1))/(((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupJ + IJupJ*h)*(resAval - 1) + 1)^2*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) + 1)*(g0 + (c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) - beta0*(IAupJ + IJupJ*h)*(eps + resJval - 1) + 1)) + (a0*g0*(beta0*(IAdownJ + IJdownJ*h) + (c1a*c2a*exp(-c2a*resAval))/(exp(-c2a) - 1))*((alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha + g0 + (c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) + 1) - beta0*f*(IAdownJ + IJdownJ*h)*(resAval - 1)*(alpha + g0 + (c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(IAdownJ + IJdownJ*h)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) + 1)*(eps - resJval + 1))*(IAdownJ + IJdownJ + SAdownJ + SJdownJ - 1))/(((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) + 1)^2*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0 + beta0*(IAdownJ + IJdownJ*h)*(eps - resJval + 1) + (c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) + 1)) + (a0*c1a*c2a*g0*exp(-c2a*resAval)*(beta0*f*(IAupJ + IJupJ*h)*(resAval - 1)*(alpha + g0 + (c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) + 1) - (alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(IAupJ + IJupJ*h)*(eps + resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupJ + IJupJ*h)*(resAval - 1) + 1))*(IAupJ + IJupJ + SAupJ + SJupJ - 1))/((exp(-c2a) - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupJ + IJupJ*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)^2*(alpha + g0 + (c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) + 1)*(g0 + (c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) - beta0*(IAupJ + IJupJ*h)*(eps + resJval - 1) + 1)) + (a0*c1a*c2a*g0*exp(-c2a*resAval)*((alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha + g0 + (c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) + 1) - beta0*f*(IAdownJ + IJdownJ*h)*(resAval - 1)*(alpha + g0 + (c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(IAdownJ + IJdownJ*h)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) + 1)*(eps - resJval + 1))*(IAdownJ + IJdownJ + SAdownJ + SJdownJ - 1))/((exp(-c2a) - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)^2*(g0 + beta0*(IAdownJ + IJdownJ*h)*(eps - resJval + 1) + (c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) + 1)))/(2*eps);
    
elseif version==3
    deriv2J=(2*a0*beta0*c1g*c2g*f*g0*exp(-c2g*resJval)*(IAval + IJval*h)*(IAval + IJval + SAval + SJval - 1))/((exp(-c2g) - 1)*(g0 - beta0*(IAval + IJval*h)*(resJval - 1) + 1)*(alpha + g0 + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)) - (2*a0*beta0^2*g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(IAval + IJval*h)^2*(beta0*f*(IAval + IJval*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1) - (alpha + g0 + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1) + beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha + g0 + 1))*(IAval + IJval + SAval + SJval - 1))/((g0 - beta0*(IAval + IJval*h)*(resJval - 1) + 1)^3*(alpha + g0 + 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)) - (a0*c1g*c2g^2*g0*exp(-c2g*resJval)*(beta0*f*(IAval + IJval*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1) - (alpha + g0 + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1) + beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha + g0 + 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2g) - 1)*(g0 - beta0*(IAval + IJval*h)*(resJval - 1) + 1)*(alpha + g0 + 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)) - (2*a0*beta0^2*f*g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(IAval + IJval*h)^2*(IAval + IJval + SAval + SJval - 1))/((g0 - beta0*(IAval + IJval*h)*(resJval - 1) + 1)^2*(alpha + g0 + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)) + (2*a0*beta0*c1g*c2g*g0*exp(-c2g*resJval)*(IAval + IJval*h)*(beta0*f*(IAval + IJval*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1) - (alpha + g0 + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1) + beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha + g0 + 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2g) - 1)*(g0 - beta0*(IAval + IJval*h)*(resJval - 1) + 1)^2*(alpha + g0 + 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1));
    deriv2A=(a0*g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*((c1a*c2a^2*exp(-c2a*resAval)*(alpha + g0 + 1))/(exp(-c2a) - 1) - (beta0*c1a*c2a^2*f*exp(-c2a*resAval)*(IAval + IJval*h)*(resJval - 1))/(exp(-c2a) - 1))*(IAval + IJval + SAval + SJval - 1))/((g0 - beta0*(IAval + IJval*h)*(resJval - 1) + 1)*(alpha + g0 + 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)) - (2*a0*g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*(IAval + IJval*h) + (c1a*c2a*exp(-c2a*resAval))/(exp(-c2a) - 1))*(beta0*f*(IAval + IJval*h)*(alpha + g0 + 1) - beta0*f*(beta0*(IAval + IJval*h) + (c1a*c2a*exp(-c2a*resAval))/(exp(-c2a) - 1))*(IAval + IJval*h)*(resJval - 1) + (c1a*c2a*exp(-c2a*resAval)*(alpha + g0 + 1))/(exp(-c2a) - 1))*(IAval + IJval + SAval + SJval - 1))/((g0 - beta0*(IAval + IJval*h)*(resJval - 1) + 1)*(alpha + g0 + 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1)^2*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)) - (2*a0*g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*(IAval + IJval*h) + (c1a*c2a*exp(-c2a*resAval))/(exp(-c2a) - 1))^2*(beta0*f*(IAval + IJval*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1) - (alpha + g0 + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1) + beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha + g0 + 1))*(IAval + IJval + SAval + SJval - 1))/((g0 - beta0*(IAval + IJval*h)*(resJval - 1) + 1)*(alpha + g0 + 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1)^3*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)) - (2*a0*c1a^2*c2a^2*g0*exp(-2*c2a*resAval)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*f*(IAval + IJval*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1) - (alpha + g0 + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1) + beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha + g0 + 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2a) - 1)^2*(g0 - beta0*(IAval + IJval*h)*(resJval - 1) + 1)*(alpha + g0 + 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)^3) - (2*a0*c1a*c2a*g0*exp(-c2a*resAval)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*f*(IAval + IJval*h)*(alpha + g0 + 1) - beta0*f*(beta0*(IAval + IJval*h) + (c1a*c2a*exp(-c2a*resAval))/(exp(-c2a) - 1))*(IAval + IJval*h)*(resJval - 1) + (c1a*c2a*exp(-c2a*resAval)*(alpha + g0 + 1))/(exp(-c2a) - 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2a) - 1)*(g0 - beta0*(IAval + IJval*h)*(resJval - 1) + 1)*(alpha + g0 + 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)^2) + (a0*c1a*c2a^2*g0*exp(-c2a*resAval)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*f*(IAval + IJval*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1) - (alpha + g0 + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1) + beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha + g0 + 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2a) - 1)*(g0 - beta0*(IAval + IJval*h)*(resJval - 1) + 1)*(alpha + g0 + 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)^2) + (a0*c1a*c2a^2*g0*exp(-c2a*resAval)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*f*(IAval + IJval*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1) - (alpha + g0 + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1) + beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha + g0 + 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2a) - 1)*(g0 - beta0*(IAval + IJval*h)*(resJval - 1) + 1)*(alpha + g0 + 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1)^2*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)) - (2*a0*c1a*c2a*g0*exp(-c2a*resAval)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*(IAval + IJval*h) + (c1a*c2a*exp(-c2a*resAval))/(exp(-c2a) - 1))*(beta0*f*(IAval + IJval*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1) - (alpha + g0 + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1) + beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha + g0 + 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2a) - 1)*(g0 - beta0*(IAval + IJval*h)*(resJval - 1) + 1)*(alpha + g0 + 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1)^2*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)^2);
    
    cderivJ1=((a0*beta0*f*g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(IAdownJ + IJdownJ*h)*(IAdownJ + IJdownJ + SAdownJ + SJdownJ - 1))/((g0 - beta0*(IAdownJ + IJdownJ*h)*(resJval - 1) + 1)*(alpha + g0 + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)) - (a0*beta0*f*g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(IAupJ + IJupJ*h)*(IAupJ + IJupJ + SAupJ + SJupJ - 1))/((g0 - beta0*(IAupJ + IJupJ*h)*(resJval - 1) + 1)*(alpha + g0 + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)) + (a0*beta0*g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(IAdownJ + IJdownJ*h)*(beta0*f*(IAdownJ + IJdownJ*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) + 1) - (alpha + g0 + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1) + beta0*f*(IAdownJ + IJdownJ*h)*(resAval - 1)*(alpha + g0 + 1))*(IAdownJ + IJdownJ + SAdownJ + SJdownJ - 1))/((g0 - beta0*(IAdownJ + IJdownJ*h)*(resJval - 1) + 1)^2*(alpha + g0 + 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)) - (a0*beta0*g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(IAupJ + IJupJ*h)*(beta0*f*(IAupJ + IJupJ*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupJ + IJupJ*h)*(resAval - 1) + 1) - (alpha + g0 + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1) + beta0*f*(IAupJ + IJupJ*h)*(resAval - 1)*(alpha + g0 + 1))*(IAupJ + IJupJ + SAupJ + SJupJ - 1))/((g0 - beta0*(IAupJ + IJupJ*h)*(resJval - 1) + 1)^2*(alpha + g0 + 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupJ + IJupJ*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)) - (a0*c1g*c2g*g0*exp(-c2g*resJval)*(beta0*f*(IAdownJ + IJdownJ*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) + 1) - (alpha + g0 + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1) + beta0*f*(IAdownJ + IJdownJ*h)*(resAval - 1)*(alpha + g0 + 1))*(IAdownJ + IJdownJ + SAdownJ + SJdownJ - 1))/((exp(-c2g) - 1)*(g0 - beta0*(IAdownJ + IJdownJ*h)*(resJval - 1) + 1)*(alpha + g0 + 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)) + (a0*c1g*c2g*g0*exp(-c2g*resJval)*(beta0*f*(IAupJ + IJupJ*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupJ + IJupJ*h)*(resAval - 1) + 1) - (alpha + g0 + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1) + beta0*f*(IAupJ + IJupJ*h)*(resAval - 1)*(alpha + g0 + 1))*(IAupJ + IJupJ + SAupJ + SJupJ - 1))/((exp(-c2g) - 1)*(g0 - beta0*(IAupJ + IJupJ*h)*(resJval - 1) + 1)*(alpha + g0 + 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupJ + IJupJ*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)))/(2*eps);
    cderivJ2=((a0*beta0*f*g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(IAdownA + IJdownA*h)*(IAdownA + IJdownA + SAdownA + SJdownA - 1))/((g0 - beta0*(IAdownA + IJdownA*h)*(resJval - 1) + 1)*(alpha + g0 + 1)*(alpha + (c1a*(exp(c2a*(eps - resAval)) - 1))/(exp(-c2a) - 1) + 1)) - (a0*beta0*f*g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(IAupA + IJupA*h)*(IAupA + IJupA + SAupA + SJupA - 1))/((g0 - beta0*(IAupA + IJupA*h)*(resJval - 1) + 1)*(alpha + g0 + 1)*(alpha + (c1a*(exp(-c2a*(eps + resAval)) - 1))/(exp(-c2a) - 1) + 1)) - (a0*beta0*g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(IAdownA + IJdownA*h)*((alpha + g0 + 1)*(alpha + (c1a*(exp(c2a*(eps - resAval)) - 1))/(exp(-c2a) - 1) + 1) + beta0*f*(IAdownA + IJdownA*h)*(alpha + g0 + 1)*(eps - resAval + 1) - beta0*f*(IAdownA + IJdownA*h)*(resJval - 1)*(beta0*(IAdownA + IJdownA*h)*(eps - resAval + 1) + (c1a*(exp(c2a*(eps - resAval)) - 1))/(exp(-c2a) - 1) + 1))*(IAdownA + IJdownA + SAdownA + SJdownA - 1))/((g0 - beta0*(IAdownA + IJdownA*h)*(resJval - 1) + 1)^2*(alpha + g0 + 1)*(beta0*(IAdownA + IJdownA*h)*(eps - resAval + 1) + (c1a*(exp(c2a*(eps - resAval)) - 1))/(exp(-c2a) - 1) + 1)*(alpha + (c1a*(exp(c2a*(eps - resAval)) - 1))/(exp(-c2a) - 1) + 1)) - (a0*beta0*g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(IAupA + IJupA*h)*(beta0*f*(IAupA + IJupA*h)*(resJval - 1)*((c1a*(exp(-c2a*(eps + resAval)) - 1))/(exp(-c2a) - 1) - beta0*(IAupA + IJupA*h)*(eps + resAval - 1) + 1) - (alpha + g0 + 1)*(alpha + (c1a*(exp(-c2a*(eps + resAval)) - 1))/(exp(-c2a) - 1) + 1) + beta0*f*(IAupA + IJupA*h)*(alpha + g0 + 1)*(eps + resAval - 1))*(IAupA + IJupA + SAupA + SJupA - 1))/((g0 - beta0*(IAupA + IJupA*h)*(resJval - 1) + 1)^2*(alpha + g0 + 1)*(alpha + (c1a*(exp(-c2a*(eps + resAval)) - 1))/(exp(-c2a) - 1) + 1)*((c1a*(exp(-c2a*(eps + resAval)) - 1))/(exp(-c2a) - 1) - beta0*(IAupA + IJupA*h)*(eps + resAval - 1) + 1)) + (a0*c1g*c2g*g0*exp(-c2g*resJval)*((alpha + g0 + 1)*(alpha + (c1a*(exp(c2a*(eps - resAval)) - 1))/(exp(-c2a) - 1) + 1) + beta0*f*(IAdownA + IJdownA*h)*(alpha + g0 + 1)*(eps - resAval + 1) - beta0*f*(IAdownA + IJdownA*h)*(resJval - 1)*(beta0*(IAdownA + IJdownA*h)*(eps - resAval + 1) + (c1a*(exp(c2a*(eps - resAval)) - 1))/(exp(-c2a) - 1) + 1))*(IAdownA + IJdownA + SAdownA + SJdownA - 1))/((exp(-c2g) - 1)*(g0 - beta0*(IAdownA + IJdownA*h)*(resJval - 1) + 1)*(alpha + g0 + 1)*(beta0*(IAdownA + IJdownA*h)*(eps - resAval + 1) + (c1a*(exp(c2a*(eps - resAval)) - 1))/(exp(-c2a) - 1) + 1)*(alpha + (c1a*(exp(c2a*(eps - resAval)) - 1))/(exp(-c2a) - 1) + 1)) + (a0*c1g*c2g*g0*exp(-c2g*resJval)*(beta0*f*(IAupA + IJupA*h)*(resJval - 1)*((c1a*(exp(-c2a*(eps + resAval)) - 1))/(exp(-c2a) - 1) - beta0*(IAupA + IJupA*h)*(eps + resAval - 1) + 1) - (alpha + g0 + 1)*(alpha + (c1a*(exp(-c2a*(eps + resAval)) - 1))/(exp(-c2a) - 1) + 1) + beta0*f*(IAupA + IJupA*h)*(alpha + g0 + 1)*(eps + resAval - 1))*(IAupA + IJupA + SAupA + SJupA - 1))/((exp(-c2g) - 1)*(g0 - beta0*(IAupA + IJupA*h)*(resJval - 1) + 1)*(alpha + g0 + 1)*(alpha + (c1a*(exp(-c2a*(eps + resAval)) - 1))/(exp(-c2a) - 1) + 1)*((c1a*(exp(-c2a*(eps + resAval)) - 1))/(exp(-c2a) - 1) - beta0*(IAupA + IJupA*h)*(eps + resAval - 1) + 1)))/(2*eps);
    cderivA1=((a0*g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*f*(IAdownA + IJdownA*h)*(alpha + g0 + 1) - beta0*f*(beta0*(IAdownA + IJdownA*h) + (c1a*c2a*exp(-c2a*resAval))/(exp(-c2a) - 1))*(IAdownA + IJdownA*h)*(resJval - 1) + (c1a*c2a*exp(-c2a*resAval)*(alpha + g0 + 1))/(exp(-c2a) - 1))*(IAdownA + IJdownA + SAdownA + SJdownA - 1))/((g0 - beta0*(IAdownA + IJdownA*h)*(resJval - 1) + 1)*(alpha + g0 + 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownA + IJdownA*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)) - (a0*g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*f*(IAupA + IJupA*h)*(alpha + g0 + 1) - beta0*f*(beta0*(IAupA + IJupA*h) + (c1a*c2a*exp(-c2a*resAval))/(exp(-c2a) - 1))*(IAupA + IJupA*h)*(resJval - 1) + (c1a*c2a*exp(-c2a*resAval)*(alpha + g0 + 1))/(exp(-c2a) - 1))*(IAupA + IJupA + SAupA + SJupA - 1))/((g0 - beta0*(IAupA + IJupA*h)*(resJval - 1) + 1)*(alpha + g0 + 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupA + IJupA*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)) + (a0*g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*(IAdownA + IJdownA*h) + (c1a*c2a*exp(-c2a*resAval))/(exp(-c2a) - 1))*(beta0*f*(IAdownA + IJdownA*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownA + IJdownA*h)*(resAval - 1) + 1) - (alpha + g0 + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1) + beta0*f*(IAdownA + IJdownA*h)*(resAval - 1)*(alpha + g0 + 1))*(IAdownA + IJdownA + SAdownA + SJdownA - 1))/((g0 - beta0*(IAdownA + IJdownA*h)*(resJval - 1) + 1)*(alpha + g0 + 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownA + IJdownA*h)*(resAval - 1) + 1)^2*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)) - (a0*g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*(IAupA + IJupA*h) + (c1a*c2a*exp(-c2a*resAval))/(exp(-c2a) - 1))*(beta0*f*(IAupA + IJupA*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupA + IJupA*h)*(resAval - 1) + 1) - (alpha + g0 + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1) + beta0*f*(IAupA + IJupA*h)*(resAval - 1)*(alpha + g0 + 1))*(IAupA + IJupA + SAupA + SJupA - 1))/((g0 - beta0*(IAupA + IJupA*h)*(resJval - 1) + 1)*(alpha + g0 + 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupA + IJupA*h)*(resAval - 1) + 1)^2*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)) + (a0*c1a*c2a*g0*exp(-c2a*resAval)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*f*(IAdownA + IJdownA*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownA + IJdownA*h)*(resAval - 1) + 1) - (alpha + g0 + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1) + beta0*f*(IAdownA + IJdownA*h)*(resAval - 1)*(alpha + g0 + 1))*(IAdownA + IJdownA + SAdownA + SJdownA - 1))/((exp(-c2a) - 1)*(g0 - beta0*(IAdownA + IJdownA*h)*(resJval - 1) + 1)*(alpha + g0 + 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownA + IJdownA*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)^2) - (a0*c1a*c2a*g0*exp(-c2a*resAval)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*f*(IAupA + IJupA*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupA + IJupA*h)*(resAval - 1) + 1) - (alpha + g0 + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1) + beta0*f*(IAupA + IJupA*h)*(resAval - 1)*(alpha + g0 + 1))*(IAupA + IJupA + SAupA + SJupA - 1))/((exp(-c2a) - 1)*(g0 - beta0*(IAupA + IJupA*h)*(resJval - 1) + 1)*(alpha + g0 + 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupA + IJupA*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)^2))/(2*eps);
    cderivA2=-((a0*g0*((c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) - 1)*(beta0*f*(IAupJ + IJupJ*h)*(alpha + g0 + 1) - beta0*f*(beta0*(IAupJ + IJupJ*h) + (c1a*c2a*exp(-c2a*resAval))/(exp(-c2a) - 1))*(IAupJ + IJupJ*h)*(eps + resJval - 1) + (c1a*c2a*exp(-c2a*resAval)*(alpha + g0 + 1))/(exp(-c2a) - 1))*(IAupJ + IJupJ + SAupJ + SJupJ - 1))/((alpha + g0 + 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupJ + IJupJ*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0 - beta0*(IAupJ + IJupJ*h)*(eps + resJval - 1) + 1)) - (a0*g0*((c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) - 1)*(beta0*f*(IAdownJ + IJdownJ*h)*(alpha + g0 + 1) + (c1a*c2a*exp(-c2a*resAval)*(alpha + g0 + 1))/(exp(-c2a) - 1) + beta0*f*(beta0*(IAdownJ + IJdownJ*h) + (c1a*c2a*exp(-c2a*resAval))/(exp(-c2a) - 1))*(IAdownJ + IJdownJ*h)*(eps - resJval + 1))*(IAdownJ + IJdownJ + SAdownJ + SJdownJ - 1))/((alpha + g0 + 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0 + beta0*(IAdownJ + IJdownJ*h)*(eps - resJval + 1) + 1)) + (a0*g0*(beta0*(IAupJ + IJupJ*h) + (c1a*c2a*exp(-c2a*resAval))/(exp(-c2a) - 1))*((c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) - 1)*(beta0*f*(IAupJ + IJupJ*h)*(eps + resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupJ + IJupJ*h)*(resAval - 1) + 1) - (alpha + g0 + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1) + beta0*f*(IAupJ + IJupJ*h)*(resAval - 1)*(alpha + g0 + 1))*(IAupJ + IJupJ + SAupJ + SJupJ - 1))/((alpha + g0 + 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupJ + IJupJ*h)*(resAval - 1) + 1)^2*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0 - beta0*(IAupJ + IJupJ*h)*(eps + resJval - 1) + 1)) + (a0*g0*((c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) - 1)*(beta0*(IAdownJ + IJdownJ*h) + (c1a*c2a*exp(-c2a*resAval))/(exp(-c2a) - 1))*((alpha + g0 + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1) + beta0*f*(IAdownJ + IJdownJ*h)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) + 1)*(eps - resJval + 1) - beta0*f*(IAdownJ + IJdownJ*h)*(resAval - 1)*(alpha + g0 + 1))*(IAdownJ + IJdownJ + SAdownJ + SJdownJ - 1))/((alpha + g0 + 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) + 1)^2*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0 + beta0*(IAdownJ + IJdownJ*h)*(eps - resJval + 1) + 1)) + (a0*c1a*c2a*g0*exp(-c2a*resAval)*((c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) - 1)*(beta0*f*(IAupJ + IJupJ*h)*(eps + resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupJ + IJupJ*h)*(resAval - 1) + 1) - (alpha + g0 + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1) + beta0*f*(IAupJ + IJupJ*h)*(resAval - 1)*(alpha + g0 + 1))*(IAupJ + IJupJ + SAupJ + SJupJ - 1))/((exp(-c2a) - 1)*(alpha + g0 + 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupJ + IJupJ*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)^2*(g0 - beta0*(IAupJ + IJupJ*h)*(eps + resJval - 1) + 1)) + (a0*c1a*c2a*g0*exp(-c2a*resAval)*((c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) - 1)*((alpha + g0 + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1) + beta0*f*(IAdownJ + IJdownJ*h)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) + 1)*(eps - resJval + 1) - beta0*f*(IAdownJ + IJdownJ*h)*(resAval - 1)*(alpha + g0 + 1))*(IAdownJ + IJdownJ + SAdownJ + SJdownJ - 1))/((exp(-c2a) - 1)*(alpha + g0 + 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)^2*(g0 + beta0*(IAdownJ + IJdownJ*h)*(eps - resJval + 1) + 1)))/(2*eps);
    
elseif version==4
    deriv2J=(a0*g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*((c1g*c2g^2*g0*exp(-c2g*resJval)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1))/(exp(-c2g) - 1) - (beta0*c1g*c2g^2*f*g0*exp(-c2g*resJval)*(IAval + IJval*h)*(resAval - 1))/(exp(-c2g) - 1))*(IAval + IJval + SAval + SJval - 1))/(((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAval + IJval*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) + (2*a0*g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*(IAval + IJval*h) - (c1g*c2g*g0*exp(-c2g*resJval))/(exp(-c2g) - 1))^2*(beta0*f*(IAval + IJval*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1) - (alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1))*(IAval + IJval + SAval + SJval - 1))/(((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAval + IJval*h)*(resJval - 1) - 1)^3*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) - (2*a0*g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*(IAval + IJval*h) - (c1g*c2g*g0*exp(-c2g*resJval))/(exp(-c2g) - 1))*(beta0*f*(IAval + IJval*h)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1) - (c1g*c2g*g0*exp(-c2g*resJval)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1))/(exp(-c2g) - 1) + (beta0*c1g*c2g*f*g0*exp(-c2g*resJval)*(IAval + IJval*h)*(resAval - 1))/(exp(-c2g) - 1))*(IAval + IJval + SAval + SJval - 1))/(((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAval + IJval*h)*(resJval - 1) - 1)^2*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) + (2*a0*c1g^2*c2g^2*g0^2*exp(-2*c2g*resJval)*(beta0*f*(IAval + IJval*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1) - (alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2g) - 1)^2*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAval + IJval*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)^2) + (a0*c1g*c2g^2*g0*exp(-c2g*resJval)*(beta0*f*(IAval + IJval*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1) - (alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2g) - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAval + IJval*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) - (2*a0*c1g*c2g*g0*exp(-c2g*resJval)*(beta0*f*(IAval + IJval*h)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1) - (c1g*c2g*g0*exp(-c2g*resJval)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1))/(exp(-c2g) - 1) + (beta0*c1g*c2g*f*g0*exp(-c2g*resJval)*(IAval + IJval*h)*(resAval - 1))/(exp(-c2g) - 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2g) - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAval + IJval*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) + (2*a0*c1g*c2g*g0*exp(-c2g*resJval)*(beta0*(IAval + IJval*h) - (c1g*c2g*g0*exp(-c2g*resJval))/(exp(-c2g) - 1))*(beta0*f*(IAval + IJval*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1) - (alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2g) - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAval + IJval*h)*(resJval - 1) - 1)^2*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) + (2*a0*c1g^2*c2g^2*g0^3*exp(-2*c2g*resJval)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*f*(IAval + IJval*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1) - (alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2g) - 1)^2*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAval + IJval*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)^3) + (a0*c1g*c2g^2*g0^2*exp(-c2g*resJval)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*f*(IAval + IJval*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1) - (alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2g) - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAval + IJval*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)^2) - (a0*c1g*c2g^2*g0^2*exp(-c2g*resJval)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*f*(IAval + IJval*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1) - (alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2g) - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAval + IJval*h)*(resJval - 1) - 1)^2*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) - (2*a0*c1g*c2g*g0^2*exp(-c2g*resJval)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*f*(IAval + IJval*h)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1) - (c1g*c2g*g0*exp(-c2g*resJval)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1))/(exp(-c2g) - 1) + (beta0*c1g*c2g*f*g0*exp(-c2g*resJval)*(IAval + IJval*h)*(resAval - 1))/(exp(-c2g) - 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2g) - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAval + IJval*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)^2) + (2*a0*c1g*c2g*g0^2*exp(-c2g*resJval)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*(IAval + IJval*h) - (c1g*c2g*g0*exp(-c2g*resJval))/(exp(-c2g) - 1))*(beta0*f*(IAval + IJval*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1) - (alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2g) - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAval + IJval*h)*(resJval - 1) - 1)^2*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)^2);
    deriv2A=(2*a0*g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*(IAval + IJval*h) + (c1a*c2a*exp(-c2a*resAval))/(exp(-c2a) - 1))*(beta0*f*(IAval + IJval*h)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + (c1a*c2a*exp(-c2a*resAval)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1))/(exp(-c2a) - 1) - beta0*f*(beta0*(IAval + IJval*h) + (c1a*c2a*exp(-c2a*resAval))/(exp(-c2a) - 1))*(IAval + IJval*h)*(resJval - 1))*(IAval + IJval + SAval + SJval - 1))/(((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1)^2*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAval + IJval*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) - (a0*g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*((c1a*c2a^2*exp(-c2a*resAval)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1))/(exp(-c2a) - 1) - (beta0*c1a*c2a^2*f*exp(-c2a*resAval)*(IAval + IJval*h)*(resJval - 1))/(exp(-c2a) - 1))*(IAval + IJval + SAval + SJval - 1))/(((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAval + IJval*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) + (2*a0*g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*(IAval + IJval*h) + (c1a*c2a*exp(-c2a*resAval))/(exp(-c2a) - 1))^2*(beta0*f*(IAval + IJval*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1) - (alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1))*(IAval + IJval + SAval + SJval - 1))/(((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1)^3*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAval + IJval*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) + (2*a0*c1a*c2a*g0*exp(-c2a*resAval)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*f*(IAval + IJval*h)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + (c1a*c2a*exp(-c2a*resAval)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1))/(exp(-c2a) - 1) - beta0*f*(beta0*(IAval + IJval*h) + (c1a*c2a*exp(-c2a*resAval))/(exp(-c2a) - 1))*(IAval + IJval*h)*(resJval - 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2a) - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)^2*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAval + IJval*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) - (a0*c1a*c2a^2*g0*exp(-c2a*resAval)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*f*(IAval + IJval*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1) - (alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2a) - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)^2*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAval + IJval*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) - (a0*c1a*c2a^2*g0*exp(-c2a*resAval)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*f*(IAval + IJval*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1) - (alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2a) - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1)^2*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAval + IJval*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) + (2*a0*c1a^2*c2a^2*g0*exp(-2*c2a*resAval)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*f*(IAval + IJval*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1) - (alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2a) - 1)^2*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)^3*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAval + IJval*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) + (2*a0*c1a*c2a*g0*exp(-c2a*resAval)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*(IAval + IJval*h) + (c1a*c2a*exp(-c2a*resAval))/(exp(-c2a) - 1))*(beta0*f*(IAval + IJval*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1) - (alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2a) - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAval + IJval*h)*(resAval - 1) + 1)^2*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)^2*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAval + IJval*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1));
    
    cderivJ1=-((a0*g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*f*(IAdownJ + IJdownJ*h)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) + 1) - (c1g*c2g*g0*exp(-c2g*resJval)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1))/(exp(-c2g) - 1) + (beta0*c1g*c2g*f*g0*exp(-c2g*resJval)*(IAdownJ + IJdownJ*h)*(resAval - 1))/(exp(-c2g) - 1))*(IAdownJ + IJdownJ + SAdownJ + SJdownJ - 1))/(((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAdownJ + IJdownJ*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) - (a0*g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*f*(IAupJ + IJupJ*h)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupJ + IJupJ*h)*(resAval - 1) + 1) - (c1g*c2g*g0*exp(-c2g*resJval)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1))/(exp(-c2g) - 1) + (beta0*c1g*c2g*f*g0*exp(-c2g*resJval)*(IAupJ + IJupJ*h)*(resAval - 1))/(exp(-c2g) - 1))*(IAupJ + IJupJ + SAupJ + SJupJ - 1))/(((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupJ + IJupJ*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAupJ + IJupJ*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) - (a0*g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*(IAdownJ + IJdownJ*h) - (c1g*c2g*g0*exp(-c2g*resJval))/(exp(-c2g) - 1))*(beta0*f*(IAdownJ + IJdownJ*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) + 1) - (alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(IAdownJ + IJdownJ*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1))*(IAdownJ + IJdownJ + SAdownJ + SJdownJ - 1))/(((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAdownJ + IJdownJ*h)*(resJval - 1) - 1)^2*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) + (a0*g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*(IAupJ + IJupJ*h) - (c1g*c2g*g0*exp(-c2g*resJval))/(exp(-c2g) - 1))*(beta0*f*(IAupJ + IJupJ*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupJ + IJupJ*h)*(resAval - 1) + 1) - (alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(IAupJ + IJupJ*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1))*(IAupJ + IJupJ + SAupJ + SJupJ - 1))/(((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupJ + IJupJ*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAupJ + IJupJ*h)*(resJval - 1) - 1)^2*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) - (a0*c1g*c2g*g0*exp(-c2g*resJval)*(beta0*f*(IAdownJ + IJdownJ*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) + 1) - (alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(IAdownJ + IJdownJ*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1))*(IAdownJ + IJdownJ + SAdownJ + SJdownJ - 1))/((exp(-c2g) - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAdownJ + IJdownJ*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) + (a0*c1g*c2g*g0*exp(-c2g*resJval)*(beta0*f*(IAupJ + IJupJ*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupJ + IJupJ*h)*(resAval - 1) + 1) - (alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(IAupJ + IJupJ*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1))*(IAupJ + IJupJ + SAupJ + SJupJ - 1))/((exp(-c2g) - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupJ + IJupJ*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAupJ + IJupJ*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) - (a0*c1g*c2g*g0^2*exp(-c2g*resJval)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*f*(IAdownJ + IJdownJ*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) + 1) - (alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(IAdownJ + IJdownJ*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1))*(IAdownJ + IJdownJ + SAdownJ + SJdownJ - 1))/((exp(-c2g) - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAdownJ + IJdownJ*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)^2) + (a0*c1g*c2g*g0^2*exp(-c2g*resJval)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*f*(IAupJ + IJupJ*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupJ + IJupJ*h)*(resAval - 1) + 1) - (alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(IAupJ + IJupJ*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1))*(IAupJ + IJupJ + SAupJ + SJupJ - 1))/((exp(-c2g) - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupJ + IJupJ*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAupJ + IJupJ*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)^2))/(2*eps);
    cderivJ2=-((a0*g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*(IAupA + IJupA*h) - (c1g*c2g*g0*exp(-c2g*resJval))/(exp(-c2g) - 1))*(beta0*f*(IAupA + IJupA*h)*(resJval - 1)*((c1a*(exp(-c2a*(eps + resAval)) - 1))/(exp(-c2a) - 1) - beta0*(IAupA + IJupA*h)*(eps + resAval - 1) + 1) - (alpha + (c1a*(exp(-c2a*(eps + resAval)) - 1))/(exp(-c2a) - 1) + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(IAupA + IJupA*h)*(eps + resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1))*(IAupA + IJupA + SAupA + SJupA - 1))/((alpha + (c1a*(exp(-c2a*(eps + resAval)) - 1))/(exp(-c2a) - 1) + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAupA + IJupA*h)*(resJval - 1) - 1)^2*((c1a*(exp(-c2a*(eps + resAval)) - 1))/(exp(-c2a) - 1) - beta0*(IAupA + IJupA*h)*(eps + resAval - 1) + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) - (a0*g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*f*(IAupA + IJupA*h)*((c1a*(exp(-c2a*(eps + resAval)) - 1))/(exp(-c2a) - 1) - beta0*(IAupA + IJupA*h)*(eps + resAval - 1) + 1) - (c1g*c2g*g0*exp(-c2g*resJval)*(alpha + (c1a*(exp(-c2a*(eps + resAval)) - 1))/(exp(-c2a) - 1) + 1))/(exp(-c2g) - 1) + (beta0*c1g*c2g*f*g0*exp(-c2g*resJval)*(IAupA + IJupA*h)*(eps + resAval - 1))/(exp(-c2g) - 1))*(IAupA + IJupA + SAupA + SJupA - 1))/((alpha + (c1a*(exp(-c2a*(eps + resAval)) - 1))/(exp(-c2a) - 1) + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAupA + IJupA*h)*(resJval - 1) - 1)*((c1a*(exp(-c2a*(eps + resAval)) - 1))/(exp(-c2a) - 1) - beta0*(IAupA + IJupA*h)*(eps + resAval - 1) + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) - (a0*g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*((c1g*c2g*g0*exp(-c2g*resJval)*(alpha + (c1a*(exp(c2a*(eps - resAval)) - 1))/(exp(-c2a) - 1) + 1))/(exp(-c2g) - 1) - beta0*f*(IAdownA + IJdownA*h)*(beta0*(IAdownA + IJdownA*h)*(eps - resAval + 1) + (c1a*(exp(c2a*(eps - resAval)) - 1))/(exp(-c2a) - 1) + 1) + (beta0*c1g*c2g*f*g0*exp(-c2g*resJval)*(IAdownA + IJdownA*h)*(eps - resAval + 1))/(exp(-c2g) - 1))*(IAdownA + IJdownA + SAdownA + SJdownA - 1))/((beta0*(IAdownA + IJdownA*h)*(eps - resAval + 1) + (c1a*(exp(c2a*(eps - resAval)) - 1))/(exp(-c2a) - 1) + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAdownA + IJdownA*h)*(resJval - 1) - 1)*(alpha + (c1a*(exp(c2a*(eps - resAval)) - 1))/(exp(-c2a) - 1) + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) + (a0*g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*(IAdownA + IJdownA*h) - (c1g*c2g*g0*exp(-c2g*resJval))/(exp(-c2g) - 1))*((alpha + (c1a*(exp(c2a*(eps - resAval)) - 1))/(exp(-c2a) - 1) + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(IAdownA + IJdownA*h)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)*(eps - resAval + 1) - beta0*f*(IAdownA + IJdownA*h)*(resJval - 1)*(beta0*(IAdownA + IJdownA*h)*(eps - resAval + 1) + (c1a*(exp(c2a*(eps - resAval)) - 1))/(exp(-c2a) - 1) + 1))*(IAdownA + IJdownA + SAdownA + SJdownA - 1))/((beta0*(IAdownA + IJdownA*h)*(eps - resAval + 1) + (c1a*(exp(c2a*(eps - resAval)) - 1))/(exp(-c2a) - 1) + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAdownA + IJdownA*h)*(resJval - 1) - 1)^2*(alpha + (c1a*(exp(c2a*(eps - resAval)) - 1))/(exp(-c2a) - 1) + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) + (a0*c1g*c2g*g0*exp(-c2g*resJval)*((alpha + (c1a*(exp(c2a*(eps - resAval)) - 1))/(exp(-c2a) - 1) + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(IAdownA + IJdownA*h)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)*(eps - resAval + 1) - beta0*f*(IAdownA + IJdownA*h)*(resJval - 1)*(beta0*(IAdownA + IJdownA*h)*(eps - resAval + 1) + (c1a*(exp(c2a*(eps - resAval)) - 1))/(exp(-c2a) - 1) + 1))*(IAdownA + IJdownA + SAdownA + SJdownA - 1))/((exp(-c2g) - 1)*(beta0*(IAdownA + IJdownA*h)*(eps - resAval + 1) + (c1a*(exp(c2a*(eps - resAval)) - 1))/(exp(-c2a) - 1) + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAdownA + IJdownA*h)*(resJval - 1) - 1)*(alpha + (c1a*(exp(c2a*(eps - resAval)) - 1))/(exp(-c2a) - 1) + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) + (a0*c1g*c2g*g0*exp(-c2g*resJval)*(beta0*f*(IAupA + IJupA*h)*(resJval - 1)*((c1a*(exp(-c2a*(eps + resAval)) - 1))/(exp(-c2a) - 1) - beta0*(IAupA + IJupA*h)*(eps + resAval - 1) + 1) - (alpha + (c1a*(exp(-c2a*(eps + resAval)) - 1))/(exp(-c2a) - 1) + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(IAupA + IJupA*h)*(eps + resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1))*(IAupA + IJupA + SAupA + SJupA - 1))/((exp(-c2g) - 1)*(alpha + (c1a*(exp(-c2a*(eps + resAval)) - 1))/(exp(-c2a) - 1) + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAupA + IJupA*h)*(resJval - 1) - 1)*((c1a*(exp(-c2a*(eps + resAval)) - 1))/(exp(-c2a) - 1) - beta0*(IAupA + IJupA*h)*(eps + resAval - 1) + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) + (a0*c1g*c2g*g0^2*exp(-c2g*resJval)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*((alpha + (c1a*(exp(c2a*(eps - resAval)) - 1))/(exp(-c2a) - 1) + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(IAdownA + IJdownA*h)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)*(eps - resAval + 1) - beta0*f*(IAdownA + IJdownA*h)*(resJval - 1)*(beta0*(IAdownA + IJdownA*h)*(eps - resAval + 1) + (c1a*(exp(c2a*(eps - resAval)) - 1))/(exp(-c2a) - 1) + 1))*(IAdownA + IJdownA + SAdownA + SJdownA - 1))/((exp(-c2g) - 1)*(beta0*(IAdownA + IJdownA*h)*(eps - resAval + 1) + (c1a*(exp(c2a*(eps - resAval)) - 1))/(exp(-c2a) - 1) + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAdownA + IJdownA*h)*(resJval - 1) - 1)*(alpha + (c1a*(exp(c2a*(eps - resAval)) - 1))/(exp(-c2a) - 1) + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)^2) + (a0*c1g*c2g*g0^2*exp(-c2g*resJval)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*f*(IAupA + IJupA*h)*(resJval - 1)*((c1a*(exp(-c2a*(eps + resAval)) - 1))/(exp(-c2a) - 1) - beta0*(IAupA + IJupA*h)*(eps + resAval - 1) + 1) - (alpha + (c1a*(exp(-c2a*(eps + resAval)) - 1))/(exp(-c2a) - 1) + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(IAupA + IJupA*h)*(eps + resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1))*(IAupA + IJupA + SAupA + SJupA - 1))/((exp(-c2g) - 1)*(alpha + (c1a*(exp(-c2a*(eps + resAval)) - 1))/(exp(-c2a) - 1) + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAupA + IJupA*h)*(resJval - 1) - 1)*((c1a*(exp(-c2a*(eps + resAval)) - 1))/(exp(-c2a) - 1) - beta0*(IAupA + IJupA*h)*(eps + resAval - 1) + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)^2))/(2*eps);
    cderivA1=-((a0*g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*f*(IAdownA + IJdownA*h)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + (c1a*c2a*exp(-c2a*resAval)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1))/(exp(-c2a) - 1) - beta0*f*(beta0*(IAdownA + IJdownA*h) + (c1a*c2a*exp(-c2a*resAval))/(exp(-c2a) - 1))*(IAdownA + IJdownA*h)*(resJval - 1))*(IAdownA + IJdownA + SAdownA + SJdownA - 1))/(((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownA + IJdownA*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAdownA + IJdownA*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) - (a0*g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*f*(IAupA + IJupA*h)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + (c1a*c2a*exp(-c2a*resAval)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1))/(exp(-c2a) - 1) - beta0*f*(beta0*(IAupA + IJupA*h) + (c1a*c2a*exp(-c2a*resAval))/(exp(-c2a) - 1))*(IAupA + IJupA*h)*(resJval - 1))*(IAupA + IJupA + SAupA + SJupA - 1))/(((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupA + IJupA*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAupA + IJupA*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) + (a0*g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*(IAdownA + IJdownA*h) + (c1a*c2a*exp(-c2a*resAval))/(exp(-c2a) - 1))*(beta0*f*(IAdownA + IJdownA*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownA + IJdownA*h)*(resAval - 1) + 1) - (alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(IAdownA + IJdownA*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1))*(IAdownA + IJdownA + SAdownA + SJdownA - 1))/(((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownA + IJdownA*h)*(resAval - 1) + 1)^2*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAdownA + IJdownA*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) - (a0*g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*(IAupA + IJupA*h) + (c1a*c2a*exp(-c2a*resAval))/(exp(-c2a) - 1))*(beta0*f*(IAupA + IJupA*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupA + IJupA*h)*(resAval - 1) + 1) - (alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(IAupA + IJupA*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1))*(IAupA + IJupA + SAupA + SJupA - 1))/(((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupA + IJupA*h)*(resAval - 1) + 1)^2*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAupA + IJupA*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) + (a0*c1a*c2a*g0*exp(-c2a*resAval)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*f*(IAdownA + IJdownA*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownA + IJdownA*h)*(resAval - 1) + 1) - (alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(IAdownA + IJdownA*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1))*(IAdownA + IJdownA + SAdownA + SJdownA - 1))/((exp(-c2a) - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownA + IJdownA*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)^2*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAdownA + IJdownA*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)) - (a0*c1a*c2a*g0*exp(-c2a*resAval)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*f*(IAupA + IJupA*h)*(resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupA + IJupA*h)*(resAval - 1) + 1) - (alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(IAupA + IJupA*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1))*(IAupA + IJupA + SAupA + SJupA - 1))/((exp(-c2a) - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupA + IJupA*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)^2*(g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAupA + IJupA*h)*(resJval - 1) - 1)*(alpha - g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1) + 1)))/(2*eps);
    cderivA2=((a0*g0*((c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) - 1)*(beta0*f*(IAdownJ + IJdownJ*h)*(alpha - g0*((c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) - 1) + 1) + (c1a*c2a*exp(-c2a*resAval)*(alpha - g0*((c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) - 1) + 1))/(exp(-c2a) - 1) + beta0*f*(beta0*(IAdownJ + IJdownJ*h) + (c1a*c2a*exp(-c2a*resAval))/(exp(-c2a) - 1))*(IAdownJ + IJdownJ*h)*(eps - resJval + 1))*(IAdownJ + IJdownJ + SAdownJ + SJdownJ - 1))/(((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) + 1)*(beta0*(IAdownJ + IJdownJ*h)*(eps - resJval + 1) - g0*((c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha - g0*((c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) - 1) + 1)) + (a0*g0*((c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) - 1)*(beta0*f*(IAupJ + IJupJ*h)*(alpha - g0*((c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) - 1) + 1) - beta0*f*(beta0*(IAupJ + IJupJ*h) + (c1a*c2a*exp(-c2a*resAval))/(exp(-c2a) - 1))*(IAupJ + IJupJ*h)*(eps + resJval - 1) + (c1a*c2a*exp(-c2a*resAval)*(alpha - g0*((c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) - 1) + 1))/(exp(-c2a) - 1))*(IAupJ + IJupJ + SAupJ + SJupJ - 1))/((alpha - g0*((c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) - 1) + 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupJ + IJupJ*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0*((c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAupJ + IJupJ*h)*(eps + resJval - 1) - 1)) + (a0*g0*(beta0*(IAupJ + IJupJ*h) + (c1a*c2a*exp(-c2a*resAval))/(exp(-c2a) - 1))*((c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) - 1)*(beta0*f*(IAupJ + IJupJ*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) - 1) + 1) - (alpha - g0*((c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1) + beta0*f*(IAupJ + IJupJ*h)*(eps + resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupJ + IJupJ*h)*(resAval - 1) + 1))*(IAupJ + IJupJ + SAupJ + SJupJ - 1))/((alpha - g0*((c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) - 1) + 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupJ + IJupJ*h)*(resAval - 1) + 1)^2*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(g0*((c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAupJ + IJupJ*h)*(eps + resJval - 1) - 1)) - (a0*g0*((c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) - 1)*(beta0*(IAdownJ + IJdownJ*h) + (c1a*c2a*exp(-c2a*resAval))/(exp(-c2a) - 1))*((alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha - g0*((c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) - 1) + 1) - beta0*f*(IAdownJ + IJdownJ*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(IAdownJ + IJdownJ*h)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) + 1)*(eps - resJval + 1))*(IAdownJ + IJdownJ + SAdownJ + SJdownJ - 1))/(((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) + 1)^2*(beta0*(IAdownJ + IJdownJ*h)*(eps - resJval + 1) - g0*((c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha - g0*((c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) - 1) + 1)) - (a0*c1a*c2a*g0*exp(-c2a*resAval)*((c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) - 1)*((alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)*(alpha - g0*((c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) - 1) + 1) - beta0*f*(IAdownJ + IJdownJ*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) - 1) + 1) + beta0*f*(IAdownJ + IJdownJ*h)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) + 1)*(eps - resJval + 1))*(IAdownJ + IJdownJ + SAdownJ + SJdownJ - 1))/((exp(-c2a) - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) + 1)*(beta0*(IAdownJ + IJdownJ*h)*(eps - resJval + 1) - g0*((c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)^2*(alpha - g0*((c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) - 1) + 1)) + (a0*c1a*c2a*g0*exp(-c2a*resAval)*((c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) - 1)*(beta0*f*(IAupJ + IJupJ*h)*(resAval - 1)*(alpha - g0*((c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) - 1) + 1) - (alpha - g0*((c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1) + beta0*f*(IAupJ + IJupJ*h)*(eps + resJval - 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupJ + IJupJ*h)*(resAval - 1) + 1))*(IAupJ + IJupJ + SAupJ + SJupJ - 1))/((exp(-c2a) - 1)*(alpha - g0*((c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) - 1) + 1)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - beta0*(IAupJ + IJupJ*h)*(resAval - 1) + 1)*(alpha + (c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) + 1)^2*(g0*((c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) - 1) + beta0*(IAupJ + IJupJ*h)*(eps + resJval - 1) - 1)))/(2*eps);
    
elseif version==5
    deriv2J=(a0*c1g*c2g^2*g0*exp(-c2g*resJval)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((alpha + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(IAval + IJval*h)*(resJval - 1) - beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2g) - 1)*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(alpha + 1)*(g0 - beta0*(IAval + IJval*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)^2) - (2*a0*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*(beta0*(IAval + IJval*h) + (c1g*c2g*exp(-c2g*resJval))/(exp(-c2g) - 1))^2*((alpha + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(IAval + IJval*h)*(resJval - 1) - beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))*(IAval + IJval + SAval + SJval - 1))/((beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(alpha + 1)*(g0 - beta0*(IAval + IJval*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)^3*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)) - (2*a0*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*(beta0*(IAval + IJval*h) + (c1g*c2g*exp(-c2g*resJval))/(exp(-c2g) - 1))*(beta0*f*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(IAval + IJval*h) - (c1g*c2g*exp(-c2g*resJval)*(alpha + 1))/(exp(-c2g) - 1) + (beta0*c1g*c2g*f*exp(-c2g*resJval)*(IAval + IJval*h)*(resAval - 1))/(exp(-c2g) - 1))*(IAval + IJval + SAval + SJval - 1))/((beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(alpha + 1)*(g0 - beta0*(IAval + IJval*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)^2*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)) - (2*a0*c1g^2*c2g^2*g0*exp(-2*c2g*resJval)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((alpha + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(IAval + IJval*h)*(resJval - 1) - beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2g) - 1)^2*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(alpha + 1)*(g0 - beta0*(IAval + IJval*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)^3) - (2*a0*c1g*c2g*g0*exp(-c2g*resJval)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*(beta0*f*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(IAval + IJval*h) - (c1g*c2g*exp(-c2g*resJval)*(alpha + 1))/(exp(-c2g) - 1) + (beta0*c1g*c2g*f*exp(-c2g*resJval)*(IAval + IJval*h)*(resAval - 1))/(exp(-c2g) - 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2g) - 1)*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(alpha + 1)*(g0 - beta0*(IAval + IJval*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)^2) - (a0*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((c1g*c2g^2*exp(-c2g*resJval)*(alpha + 1))/(exp(-c2g) - 1) - (beta0*c1g*c2g^2*f*exp(-c2g*resJval)*(IAval + IJval*h)*(resAval - 1))/(exp(-c2g) - 1))*(IAval + IJval + SAval + SJval - 1))/((beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(alpha + 1)*(g0 - beta0*(IAval + IJval*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)) + (a0*c1g*c2g^2*g0*exp(-c2g*resJval)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((alpha + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(IAval + IJval*h)*(resJval - 1) - beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2g) - 1)*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(alpha + 1)*(g0 - beta0*(IAval + IJval*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)^2*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)) - (2*a0*c1g*c2g*g0*exp(-c2g*resJval)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*(beta0*(IAval + IJval*h) + (c1g*c2g*exp(-c2g*resJval))/(exp(-c2g) - 1))*((alpha + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(IAval + IJval*h)*(resJval - 1) - beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2g) - 1)*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(alpha + 1)*(g0 - beta0*(IAval + IJval*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)^2*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)^2);
    deriv2A=(2*a0*beta0*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*(beta0^2*f*(IAval + IJval*h)^2*(resJval - 1) - beta0*f*(IAval + IJval*h)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))*(IAval + IJval*h)*(IAval + IJval + SAval + SJval - 1))/((beta0*(IAval + IJval*h)*(resAval - 1) - 1)^2*(alpha + 1)*(g0 - beta0*(IAval + IJval*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)) - (2*a0*beta0^2*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*(IAval + IJval*h)^2*((alpha + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(IAval + IJval*h)*(resJval - 1) - beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))*(IAval + IJval + SAval + SJval - 1))/((beta0*(IAval + IJval*h)*(resAval - 1) - 1)^3*(alpha + 1)*(g0 - beta0*(IAval + IJval*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)) + (2*a0*c1a*c2a*g0*exp(-c2a*resAval)*(beta0^2*f*(IAval + IJval*h)^2*(resJval - 1) - beta0*f*(IAval + IJval*h)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2a) - 1)*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(alpha + 1)*(g0 - beta0*(IAval + IJval*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)) - (a0*c1a*c2a^2*g0*exp(-c2a*resAval)*((alpha + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(IAval + IJval*h)*(resJval - 1) - beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2a) - 1)*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(alpha + 1)*(g0 - beta0*(IAval + IJval*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)) - (2*a0*beta0*c1a*c2a*g0*exp(-c2a*resAval)*(IAval + IJval*h)*((alpha + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(IAval + IJval*h)*(resJval - 1) - beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2a) - 1)*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)^2*(alpha + 1)*(g0 - beta0*(IAval + IJval*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1));
    
    cderivJ1=((a0*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*(beta0*f*(beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) - 1)*(IAdownJ + IJdownJ*h) - (c1g*c2g*exp(-c2g*resJval)*(alpha + 1))/(exp(-c2g) - 1) + (beta0*c1g*c2g*f*exp(-c2g*resJval)*(IAdownJ + IJdownJ*h)*(resAval - 1))/(exp(-c2g) - 1))*(IAdownJ + IJdownJ + SAdownJ + SJdownJ - 1))/((beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) - 1)*(alpha + 1)*(g0 - beta0*(IAdownJ + IJdownJ*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)) - (a0*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*(beta0*f*(beta0*(IAupJ + IJupJ*h)*(resAval - 1) - 1)*(IAupJ + IJupJ*h) - (c1g*c2g*exp(-c2g*resJval)*(alpha + 1))/(exp(-c2g) - 1) + (beta0*c1g*c2g*f*exp(-c2g*resJval)*(IAupJ + IJupJ*h)*(resAval - 1))/(exp(-c2g) - 1))*(IAupJ + IJupJ + SAupJ + SJupJ - 1))/((beta0*(IAupJ + IJupJ*h)*(resAval - 1) - 1)*(alpha + 1)*(g0 - beta0*(IAupJ + IJupJ*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)) + (a0*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*(beta0*(IAdownJ + IJdownJ*h) + (c1g*c2g*exp(-c2g*resJval))/(exp(-c2g) - 1))*((alpha + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) - 1)*(IAdownJ + IJdownJ*h)*(resJval - 1) - beta0*f*(IAdownJ + IJdownJ*h)*(resAval - 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))*(IAdownJ + IJdownJ + SAdownJ + SJdownJ - 1))/((beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) - 1)*(alpha + 1)*(g0 - beta0*(IAdownJ + IJdownJ*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)^2*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)) - (a0*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*(beta0*(IAupJ + IJupJ*h) + (c1g*c2g*exp(-c2g*resJval))/(exp(-c2g) - 1))*((alpha + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(beta0*(IAupJ + IJupJ*h)*(resAval - 1) - 1)*(IAupJ + IJupJ*h)*(resJval - 1) - beta0*f*(IAupJ + IJupJ*h)*(resAval - 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))*(IAupJ + IJupJ + SAupJ + SJupJ - 1))/((beta0*(IAupJ + IJupJ*h)*(resAval - 1) - 1)*(alpha + 1)*(g0 - beta0*(IAupJ + IJupJ*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)^2*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)) + (a0*c1g*c2g*g0*exp(-c2g*resJval)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((alpha + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) - 1)*(IAdownJ + IJdownJ*h)*(resJval - 1) - beta0*f*(IAdownJ + IJdownJ*h)*(resAval - 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))*(IAdownJ + IJdownJ + SAdownJ + SJdownJ - 1))/((exp(-c2g) - 1)*(beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) - 1)*(alpha + 1)*(g0 - beta0*(IAdownJ + IJdownJ*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)^2) - (a0*c1g*c2g*g0*exp(-c2g*resJval)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((alpha + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(beta0*(IAupJ + IJupJ*h)*(resAval - 1) - 1)*(IAupJ + IJupJ*h)*(resJval - 1) - beta0*f*(IAupJ + IJupJ*h)*(resAval - 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))*(IAupJ + IJupJ + SAupJ + SJupJ - 1))/((exp(-c2g) - 1)*(beta0*(IAupJ + IJupJ*h)*(resAval - 1) - 1)*(alpha + 1)*(g0 - beta0*(IAupJ + IJupJ*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)^2))/(2*eps);
    cderivJ2=-((a0*g0*((c1a*(exp(-c2a*(eps + resAval)) - 1))/(exp(-c2a) - 1) - 1)*(beta0*f*(beta0*(IAupA + IJupA*h)*(eps + resAval - 1) - 1)*(IAupA + IJupA*h) - (c1g*c2g*exp(-c2g*resJval)*(alpha + 1))/(exp(-c2g) - 1) + (beta0*c1g*c2g*f*exp(-c2g*resJval)*(IAupA + IJupA*h)*(eps + resAval - 1))/(exp(-c2g) - 1))*(IAupA + IJupA + SAupA + SJupA - 1))/((beta0*(IAupA + IJupA*h)*(eps + resAval - 1) - 1)*(alpha + 1)*(g0 - beta0*(IAupA + IJupA*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)) - (a0*g0*((c1a*(exp(c2a*(eps - resAval)) - 1))/(exp(-c2a) - 1) - 1)*(beta0*f*(beta0*(IAdownA + IJdownA*h)*(eps - resAval + 1) + 1)*(IAdownA + IJdownA*h) + (c1g*c2g*exp(-c2g*resJval)*(alpha + 1))/(exp(-c2g) - 1) + (beta0*c1g*c2g*f*exp(-c2g*resJval)*(IAdownA + IJdownA*h)*(eps - resAval + 1))/(exp(-c2g) - 1))*(IAdownA + IJdownA + SAdownA + SJdownA - 1))/((beta0*(IAdownA + IJdownA*h)*(eps - resAval + 1) + 1)*(alpha + 1)*(g0 - beta0*(IAdownA + IJdownA*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)) + (a0*g0*((c1a*(exp(c2a*(eps - resAval)) - 1))/(exp(-c2a) - 1) - 1)*(beta0*(IAdownA + IJdownA*h) + (c1g*c2g*exp(-c2g*resJval))/(exp(-c2g) - 1))*((alpha + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) - beta0*f*(beta0*(IAdownA + IJdownA*h)*(eps - resAval + 1) + 1)*(IAdownA + IJdownA*h)*(resJval - 1) + beta0*f*(IAdownA + IJdownA*h)*(eps - resAval + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))*(IAdownA + IJdownA + SAdownA + SJdownA - 1))/((beta0*(IAdownA + IJdownA*h)*(eps - resAval + 1) + 1)*(alpha + 1)*(g0 - beta0*(IAdownA + IJdownA*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)^2*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)) + (a0*g0*(beta0*(IAupA + IJupA*h) + (c1g*c2g*exp(-c2g*resJval))/(exp(-c2g) - 1))*((c1a*(exp(-c2a*(eps + resAval)) - 1))/(exp(-c2a) - 1) - 1)*((alpha + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(beta0*(IAupA + IJupA*h)*(eps + resAval - 1) - 1)*(IAupA + IJupA*h)*(resJval - 1) - beta0*f*(IAupA + IJupA*h)*(eps + resAval - 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))*(IAupA + IJupA + SAupA + SJupA - 1))/((beta0*(IAupA + IJupA*h)*(eps + resAval - 1) - 1)*(alpha + 1)*(g0 - beta0*(IAupA + IJupA*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)^2*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)) + (a0*c1g*c2g*g0*exp(-c2g*resJval)*((c1a*(exp(c2a*(eps - resAval)) - 1))/(exp(-c2a) - 1) - 1)*((alpha + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) - beta0*f*(beta0*(IAdownA + IJdownA*h)*(eps - resAval + 1) + 1)*(IAdownA + IJdownA*h)*(resJval - 1) + beta0*f*(IAdownA + IJdownA*h)*(eps - resAval + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))*(IAdownA + IJdownA + SAdownA + SJdownA - 1))/((beta0*(IAdownA + IJdownA*h)*(eps - resAval + 1) + 1)*(exp(-c2g) - 1)*(alpha + 1)*(g0 - beta0*(IAdownA + IJdownA*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)^2) + (a0*c1g*c2g*g0*exp(-c2g*resJval)*((c1a*(exp(-c2a*(eps + resAval)) - 1))/(exp(-c2a) - 1) - 1)*((alpha + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(beta0*(IAupA + IJupA*h)*(eps + resAval - 1) - 1)*(IAupA + IJupA*h)*(resJval - 1) - beta0*f*(IAupA + IJupA*h)*(eps + resAval - 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))*(IAupA + IJupA + SAupA + SJupA - 1))/((beta0*(IAupA + IJupA*h)*(eps + resAval - 1) - 1)*(exp(-c2g) - 1)*(alpha + 1)*(g0 - beta0*(IAupA + IJupA*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)^2))/(2*eps);
    cderivA1=((a0*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*(beta0^2*f*(IAdownA + IJdownA*h)^2*(resJval - 1) - beta0*f*(IAdownA + IJdownA*h)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))*(IAdownA + IJdownA + SAdownA + SJdownA - 1))/((beta0*(IAdownA + IJdownA*h)*(resAval - 1) - 1)*(alpha + 1)*(g0 - beta0*(IAdownA + IJdownA*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)) - (a0*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*(beta0^2*f*(IAupA + IJupA*h)^2*(resJval - 1) - beta0*f*(IAupA + IJupA*h)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))*(IAupA + IJupA + SAupA + SJupA - 1))/((beta0*(IAupA + IJupA*h)*(resAval - 1) - 1)*(alpha + 1)*(g0 - beta0*(IAupA + IJupA*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)) - (a0*beta0*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*(IAdownA + IJdownA*h)*((alpha + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(beta0*(IAdownA + IJdownA*h)*(resAval - 1) - 1)*(IAdownA + IJdownA*h)*(resJval - 1) - beta0*f*(IAdownA + IJdownA*h)*(resAval - 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))*(IAdownA + IJdownA + SAdownA + SJdownA - 1))/((beta0*(IAdownA + IJdownA*h)*(resAval - 1) - 1)^2*(alpha + 1)*(g0 - beta0*(IAdownA + IJdownA*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)) + (a0*beta0*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*(IAupA + IJupA*h)*((alpha + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(beta0*(IAupA + IJupA*h)*(resAval - 1) - 1)*(IAupA + IJupA*h)*(resJval - 1) - beta0*f*(IAupA + IJupA*h)*(resAval - 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))*(IAupA + IJupA + SAupA + SJupA - 1))/((beta0*(IAupA + IJupA*h)*(resAval - 1) - 1)^2*(alpha + 1)*(g0 - beta0*(IAupA + IJupA*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)) - (a0*c1a*c2a*g0*exp(-c2a*resAval)*((alpha + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(beta0*(IAdownA + IJdownA*h)*(resAval - 1) - 1)*(IAdownA + IJdownA*h)*(resJval - 1) - beta0*f*(IAdownA + IJdownA*h)*(resAval - 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))*(IAdownA + IJdownA + SAdownA + SJdownA - 1))/((exp(-c2a) - 1)*(beta0*(IAdownA + IJdownA*h)*(resAval - 1) - 1)*(alpha + 1)*(g0 - beta0*(IAdownA + IJdownA*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)) + (a0*c1a*c2a*g0*exp(-c2a*resAval)*((alpha + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(beta0*(IAupA + IJupA*h)*(resAval - 1) - 1)*(IAupA + IJupA*h)*(resJval - 1) - beta0*f*(IAupA + IJupA*h)*(resAval - 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1))*(IAupA + IJupA + SAupA + SJupA - 1))/((exp(-c2a) - 1)*(beta0*(IAupA + IJupA*h)*(resAval - 1) - 1)*(alpha + 1)*(g0 - beta0*(IAupA + IJupA*h)*(resJval - 1) + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) + 1)))/(2*eps);
    cderivA2=((a0*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*(beta0*f*(IAupJ + IJupJ*h)*(alpha + g0 + (c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) + 1) - beta0^2*f*(IAupJ + IJupJ*h)^2*(eps + resJval - 1))*(IAupJ + IJupJ + SAupJ + SJupJ - 1))/((beta0*(IAupJ + IJupJ*h)*(resAval - 1) - 1)*(alpha + 1)*(alpha + g0 + (c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) + 1)*(g0 + (c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) - beta0*(IAupJ + IJupJ*h)*(eps + resJval - 1) + 1)) - (a0*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*(beta0^2*f*(IAdownJ + IJdownJ*h)^2*(eps - resJval + 1) + beta0*f*(IAdownJ + IJdownJ*h)*(alpha + g0 + (c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) + 1))*(IAdownJ + IJdownJ + SAdownJ + SJdownJ - 1))/((beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) - 1)*(alpha + 1)*(g0 + beta0*(IAdownJ + IJdownJ*h)*(eps - resJval + 1) + (c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) + 1)) + (a0*beta0*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*(IAupJ + IJupJ*h)*((alpha + 1)*(alpha + g0 + (c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) + 1) - beta0*f*(IAupJ + IJupJ*h)*(resAval - 1)*(alpha + g0 + (c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(beta0*(IAupJ + IJupJ*h)*(resAval - 1) - 1)*(IAupJ + IJupJ*h)*(eps + resJval - 1))*(IAupJ + IJupJ + SAupJ + SJupJ - 1))/((beta0*(IAupJ + IJupJ*h)*(resAval - 1) - 1)^2*(alpha + 1)*(alpha + g0 + (c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) + 1)*(g0 + (c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) - beta0*(IAupJ + IJupJ*h)*(eps + resJval - 1) + 1)) + (a0*beta0*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*(IAdownJ + IJdownJ*h)*(beta0*f*(beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) - 1)*(IAdownJ + IJdownJ*h)*(eps - resJval + 1) - (alpha + 1)*(alpha + g0 + (c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(IAdownJ + IJdownJ*h)*(resAval - 1)*(alpha + g0 + (c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) + 1))*(IAdownJ + IJdownJ + SAdownJ + SJdownJ - 1))/((beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) - 1)^2*(alpha + 1)*(g0 + beta0*(IAdownJ + IJdownJ*h)*(eps - resJval + 1) + (c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) + 1)) + (a0*c1a*c2a*g0*exp(-c2a*resAval)*((alpha + 1)*(alpha + g0 + (c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) + 1) - beta0*f*(IAupJ + IJupJ*h)*(resAval - 1)*(alpha + g0 + (c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(beta0*(IAupJ + IJupJ*h)*(resAval - 1) - 1)*(IAupJ + IJupJ*h)*(eps + resJval - 1))*(IAupJ + IJupJ + SAupJ + SJupJ - 1))/((exp(-c2a) - 1)*(beta0*(IAupJ + IJupJ*h)*(resAval - 1) - 1)*(alpha + 1)*(alpha + g0 + (c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) + 1)*(g0 + (c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) - beta0*(IAupJ + IJupJ*h)*(eps + resJval - 1) + 1)) + (a0*c1a*c2a*g0*exp(-c2a*resAval)*(beta0*f*(beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) - 1)*(IAdownJ + IJdownJ*h)*(eps - resJval + 1) - (alpha + 1)*(alpha + g0 + (c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) + 1) + beta0*f*(IAdownJ + IJdownJ*h)*(resAval - 1)*(alpha + g0 + (c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) + 1))*(IAdownJ + IJdownJ + SAdownJ + SJdownJ - 1))/((exp(-c2a) - 1)*(beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) - 1)*(alpha + 1)*(g0 + beta0*(IAdownJ + IJdownJ*h)*(eps - resJval + 1) + (c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) + 1)*(alpha + g0 + (c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) + 1)))/(2*eps);
    
elseif version==6
    deriv2J=(2*a0*beta0^2*f*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(IAval + IJval*h)^2*(IAval + IJval + SAval + SJval - 1))/((alpha + 1)*(g0 - beta0*(IAval + IJval*h)*(resJval - 1) + 1)^2*(alpha + g0 + 1)) + (2*a0*beta0^2*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(IAval + IJval*h)^2*((alpha + 1)*(alpha + g0 + 1) + beta0*f*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(IAval + IJval*h)*(resJval - 1) - beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha + g0 + 1))*(IAval + IJval + SAval + SJval - 1))/((beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(alpha + 1)*(g0 - beta0*(IAval + IJval*h)*(resJval - 1) + 1)^3*(alpha + g0 + 1)) + (a0*c1g*c2g^2*g0*exp(-c2g*resJval)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((alpha + 1)*(alpha + g0 + 1) + beta0*f*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(IAval + IJval*h)*(resJval - 1) - beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha + g0 + 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2g) - 1)*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(alpha + 1)*(g0 - beta0*(IAval + IJval*h)*(resJval - 1) + 1)*(alpha + g0 + 1)) - (2*a0*beta0*c1g*c2g*f*g0*exp(-c2g*resJval)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*(IAval + IJval*h)*(IAval + IJval + SAval + SJval - 1))/((exp(-c2g) - 1)*(alpha + 1)*(g0 - beta0*(IAval + IJval*h)*(resJval - 1) + 1)*(alpha + g0 + 1)) - (2*a0*beta0*c1g*c2g*g0*exp(-c2g*resJval)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*(IAval + IJval*h)*((alpha + 1)*(alpha + g0 + 1) + beta0*f*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(IAval + IJval*h)*(resJval - 1) - beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha + g0 + 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2g) - 1)*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(alpha + 1)*(g0 - beta0*(IAval + IJval*h)*(resJval - 1) + 1)^2*(alpha + g0 + 1));
    deriv2A=(2*a0*beta0^2*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(IAval + IJval*h)^2*((alpha + 1)*(alpha + g0 + 1) + beta0*f*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(IAval + IJval*h)*(resJval - 1) - beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha + g0 + 1))*(IAval + IJval + SAval + SJval - 1))/((beta0*(IAval + IJval*h)*(resAval - 1) - 1)^3*(alpha + 1)*(g0 - beta0*(IAval + IJval*h)*(resJval - 1) + 1)*(alpha + g0 + 1)) + (2*a0*beta0*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(IAval + IJval*h)*(beta0*f*(IAval + IJval*h)*(alpha + g0 + 1) - beta0^2*f*(IAval + IJval*h)^2*(resJval - 1))*(IAval + IJval + SAval + SJval - 1))/((beta0*(IAval + IJval*h)*(resAval - 1) - 1)^2*(alpha + 1)*(g0 - beta0*(IAval + IJval*h)*(resJval - 1) + 1)*(alpha + g0 + 1)) + (2*a0*c1a*c2a*g0*exp(-c2a*resAval)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*f*(IAval + IJval*h)*(alpha + g0 + 1) - beta0^2*f*(IAval + IJval*h)^2*(resJval - 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2a) - 1)*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(alpha + 1)*(g0 - beta0*(IAval + IJval*h)*(resJval - 1) + 1)*(alpha + g0 + 1)) + (a0*c1a*c2a^2*g0*exp(-c2a*resAval)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*((alpha + 1)*(alpha + g0 + 1) + beta0*f*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(IAval + IJval*h)*(resJval - 1) - beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha + g0 + 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2a) - 1)*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(alpha + 1)*(g0 - beta0*(IAval + IJval*h)*(resJval - 1) + 1)*(alpha + g0 + 1)) + (2*a0*beta0*c1a*c2a*g0*exp(-c2a*resAval)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(IAval + IJval*h)*((alpha + 1)*(alpha + g0 + 1) + beta0*f*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)*(IAval + IJval*h)*(resJval - 1) - beta0*f*(IAval + IJval*h)*(resAval - 1)*(alpha + g0 + 1))*(IAval + IJval + SAval + SJval - 1))/((exp(-c2a) - 1)*(beta0*(IAval + IJval*h)*(resAval - 1) - 1)^2*(alpha + 1)*(g0 - beta0*(IAval + IJval*h)*(resJval - 1) + 1)*(alpha + g0 + 1));
    
    cderivJ1=-((a0*beta0*f*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(IAdownJ + IJdownJ*h)*(IAdownJ + IJdownJ + SAdownJ + SJdownJ - 1))/((alpha + 1)*(g0 - beta0*(IAdownJ + IJdownJ*h)*(resJval - 1) + 1)*(alpha + g0 + 1)) - (a0*beta0*f*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(IAupJ + IJupJ*h)*(IAupJ + IJupJ + SAupJ + SJupJ - 1))/((alpha + 1)*(g0 - beta0*(IAupJ + IJupJ*h)*(resJval - 1) + 1)*(alpha + g0 + 1)) + (a0*beta0*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(IAdownJ + IJdownJ*h)*((alpha + 1)*(alpha + g0 + 1) + beta0*f*(beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) - 1)*(IAdownJ + IJdownJ*h)*(resJval - 1) - beta0*f*(IAdownJ + IJdownJ*h)*(resAval - 1)*(alpha + g0 + 1))*(IAdownJ + IJdownJ + SAdownJ + SJdownJ - 1))/((beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) - 1)*(alpha + 1)*(g0 - beta0*(IAdownJ + IJdownJ*h)*(resJval - 1) + 1)^2*(alpha + g0 + 1)) - (a0*beta0*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(IAupJ + IJupJ*h)*((alpha + 1)*(alpha + g0 + 1) + beta0*f*(beta0*(IAupJ + IJupJ*h)*(resAval - 1) - 1)*(IAupJ + IJupJ*h)*(resJval - 1) - beta0*f*(IAupJ + IJupJ*h)*(resAval - 1)*(alpha + g0 + 1))*(IAupJ + IJupJ + SAupJ + SJupJ - 1))/((beta0*(IAupJ + IJupJ*h)*(resAval - 1) - 1)*(alpha + 1)*(g0 - beta0*(IAupJ + IJupJ*h)*(resJval - 1) + 1)^2*(alpha + g0 + 1)) - (a0*c1g*c2g*g0*exp(-c2g*resJval)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((alpha + 1)*(alpha + g0 + 1) + beta0*f*(beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) - 1)*(IAdownJ + IJdownJ*h)*(resJval - 1) - beta0*f*(IAdownJ + IJdownJ*h)*(resAval - 1)*(alpha + g0 + 1))*(IAdownJ + IJdownJ + SAdownJ + SJdownJ - 1))/((exp(-c2g) - 1)*(beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) - 1)*(alpha + 1)*(g0 - beta0*(IAdownJ + IJdownJ*h)*(resJval - 1) + 1)*(alpha + g0 + 1)) + (a0*c1g*c2g*g0*exp(-c2g*resJval)*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((alpha + 1)*(alpha + g0 + 1) + beta0*f*(beta0*(IAupJ + IJupJ*h)*(resAval - 1) - 1)*(IAupJ + IJupJ*h)*(resJval - 1) - beta0*f*(IAupJ + IJupJ*h)*(resAval - 1)*(alpha + g0 + 1))*(IAupJ + IJupJ + SAupJ + SJupJ - 1))/((exp(-c2g) - 1)*(beta0*(IAupJ + IJupJ*h)*(resAval - 1) - 1)*(alpha + 1)*(g0 - beta0*(IAupJ + IJupJ*h)*(resJval - 1) + 1)*(alpha + g0 + 1)))/(2*eps);
    cderivJ2=((a0*beta0*f*g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(IAupA + IJupA*h)*((c1a*(exp(-c2a*(eps + resAval)) - 1))/(exp(-c2a) - 1) - 1)*(IAupA + IJupA + SAupA + SJupA - 1))/((alpha + 1)*(g0 - beta0*(IAupA + IJupA*h)*(resJval - 1) + 1)*(alpha + g0 + 1)) - (a0*beta0*f*g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*((c1a*(exp(c2a*(eps - resAval)) - 1))/(exp(-c2a) - 1) - 1)*(IAdownA + IJdownA*h)*(IAdownA + IJdownA + SAdownA + SJdownA - 1))/((alpha + 1)*(g0 - beta0*(IAdownA + IJdownA*h)*(resJval - 1) + 1)*(alpha + g0 + 1)) + (a0*beta0*g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*((c1a*(exp(c2a*(eps - resAval)) - 1))/(exp(-c2a) - 1) - 1)*(IAdownA + IJdownA*h)*((alpha + 1)*(alpha + g0 + 1) - beta0*f*(beta0*(IAdownA + IJdownA*h)*(eps - resAval + 1) + 1)*(IAdownA + IJdownA*h)*(resJval - 1) + beta0*f*(IAdownA + IJdownA*h)*(alpha + g0 + 1)*(eps - resAval + 1))*(IAdownA + IJdownA + SAdownA + SJdownA - 1))/((beta0*(IAdownA + IJdownA*h)*(eps - resAval + 1) + 1)*(alpha + 1)*(g0 - beta0*(IAdownA + IJdownA*h)*(resJval - 1) + 1)^2*(alpha + g0 + 1)) + (a0*beta0*g0*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(IAupA + IJupA*h)*((c1a*(exp(-c2a*(eps + resAval)) - 1))/(exp(-c2a) - 1) - 1)*((alpha + 1)*(alpha + g0 + 1) - beta0*f*(IAupA + IJupA*h)*(alpha + g0 + 1)*(eps + resAval - 1) + beta0*f*(beta0*(IAupA + IJupA*h)*(eps + resAval - 1) - 1)*(IAupA + IJupA*h)*(resJval - 1))*(IAupA + IJupA + SAupA + SJupA - 1))/((beta0*(IAupA + IJupA*h)*(eps + resAval - 1) - 1)*(alpha + 1)*(g0 - beta0*(IAupA + IJupA*h)*(resJval - 1) + 1)^2*(alpha + g0 + 1)) - (a0*c1g*c2g*g0*exp(-c2g*resJval)*((c1a*(exp(-c2a*(eps + resAval)) - 1))/(exp(-c2a) - 1) - 1)*((alpha + 1)*(alpha + g0 + 1) - beta0*f*(IAupA + IJupA*h)*(alpha + g0 + 1)*(eps + resAval - 1) + beta0*f*(beta0*(IAupA + IJupA*h)*(eps + resAval - 1) - 1)*(IAupA + IJupA*h)*(resJval - 1))*(IAupA + IJupA + SAupA + SJupA - 1))/((beta0*(IAupA + IJupA*h)*(eps + resAval - 1) - 1)*(exp(-c2g) - 1)*(alpha + 1)*(g0 - beta0*(IAupA + IJupA*h)*(resJval - 1) + 1)*(alpha + g0 + 1)) - (a0*c1g*c2g*g0*exp(-c2g*resJval)*((c1a*(exp(c2a*(eps - resAval)) - 1))/(exp(-c2a) - 1) - 1)*((alpha + 1)*(alpha + g0 + 1) - beta0*f*(beta0*(IAdownA + IJdownA*h)*(eps - resAval + 1) + 1)*(IAdownA + IJdownA*h)*(resJval - 1) + beta0*f*(IAdownA + IJdownA*h)*(alpha + g0 + 1)*(eps - resAval + 1))*(IAdownA + IJdownA + SAdownA + SJdownA - 1))/((beta0*(IAdownA + IJdownA*h)*(eps - resAval + 1) + 1)*(exp(-c2g) - 1)*(alpha + 1)*(g0 - beta0*(IAdownA + IJdownA*h)*(resJval - 1) + 1)*(alpha + g0 + 1)))/(2*eps);
    cderivA1=((a0*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*f*(IAdownA + IJdownA*h)*(alpha + g0 + 1) - beta0^2*f*(IAdownA + IJdownA*h)^2*(resJval - 1))*(IAdownA + IJdownA + SAdownA + SJdownA - 1))/((beta0*(IAdownA + IJdownA*h)*(resAval - 1) - 1)*(alpha + 1)*(g0 - beta0*(IAdownA + IJdownA*h)*(resJval - 1) + 1)*(alpha + g0 + 1)) - (a0*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(beta0*f*(IAupA + IJupA*h)*(alpha + g0 + 1) - beta0^2*f*(IAupA + IJupA*h)^2*(resJval - 1))*(IAupA + IJupA + SAupA + SJupA - 1))/((beta0*(IAupA + IJupA*h)*(resAval - 1) - 1)*(alpha + 1)*(g0 - beta0*(IAupA + IJupA*h)*(resJval - 1) + 1)*(alpha + g0 + 1)) + (a0*beta0*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(IAdownA + IJdownA*h)*((alpha + 1)*(alpha + g0 + 1) + beta0*f*(beta0*(IAdownA + IJdownA*h)*(resAval - 1) - 1)*(IAdownA + IJdownA*h)*(resJval - 1) - beta0*f*(IAdownA + IJdownA*h)*(resAval - 1)*(alpha + g0 + 1))*(IAdownA + IJdownA + SAdownA + SJdownA - 1))/((beta0*(IAdownA + IJdownA*h)*(resAval - 1) - 1)^2*(alpha + 1)*(g0 - beta0*(IAdownA + IJdownA*h)*(resJval - 1) + 1)*(alpha + g0 + 1)) - (a0*beta0*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*(IAupA + IJupA*h)*((alpha + 1)*(alpha + g0 + 1) + beta0*f*(beta0*(IAupA + IJupA*h)*(resAval - 1) - 1)*(IAupA + IJupA*h)*(resJval - 1) - beta0*f*(IAupA + IJupA*h)*(resAval - 1)*(alpha + g0 + 1))*(IAupA + IJupA + SAupA + SJupA - 1))/((beta0*(IAupA + IJupA*h)*(resAval - 1) - 1)^2*(alpha + 1)*(g0 - beta0*(IAupA + IJupA*h)*(resJval - 1) + 1)*(alpha + g0 + 1)) + (a0*c1a*c2a*g0*exp(-c2a*resAval)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*((alpha + 1)*(alpha + g0 + 1) + beta0*f*(beta0*(IAdownA + IJdownA*h)*(resAval - 1) - 1)*(IAdownA + IJdownA*h)*(resJval - 1) - beta0*f*(IAdownA + IJdownA*h)*(resAval - 1)*(alpha + g0 + 1))*(IAdownA + IJdownA + SAdownA + SJdownA - 1))/((exp(-c2a) - 1)*(beta0*(IAdownA + IJdownA*h)*(resAval - 1) - 1)*(alpha + 1)*(g0 - beta0*(IAdownA + IJdownA*h)*(resJval - 1) + 1)*(alpha + g0 + 1)) - (a0*c1a*c2a*g0*exp(-c2a*resAval)*((c1g*(exp(-c2g*resJval) - 1))/(exp(-c2g) - 1) - 1)*((alpha + 1)*(alpha + g0 + 1) + beta0*f*(beta0*(IAupA + IJupA*h)*(resAval - 1) - 1)*(IAupA + IJupA*h)*(resJval - 1) - beta0*f*(IAupA + IJupA*h)*(resAval - 1)*(alpha + g0 + 1))*(IAupA + IJupA + SAupA + SJupA - 1))/((exp(-c2a) - 1)*(beta0*(IAupA + IJupA*h)*(resAval - 1) - 1)*(alpha + 1)*(g0 - beta0*(IAupA + IJupA*h)*(resJval - 1) + 1)*(alpha + g0 + 1)))/(2*eps);
    cderivA2=-((a0*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*(beta0*f*(IAupJ + IJupJ*h)*(alpha + g0 + 1) - beta0^2*f*(IAupJ + IJupJ*h)^2*(eps + resJval - 1))*((c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) - 1)*(IAupJ + IJupJ + SAupJ + SJupJ - 1))/((beta0*(IAupJ + IJupJ*h)*(resAval - 1) - 1)*(alpha + 1)*(alpha + g0 + 1)*(g0 - beta0*(IAupJ + IJupJ*h)*(eps + resJval - 1) + 1)) - (a0*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) - 1)*(beta0*f*(IAdownJ + IJdownJ*h)*(alpha + g0 + 1) + beta0^2*f*(IAdownJ + IJdownJ*h)^2*(eps - resJval + 1))*(IAdownJ + IJdownJ + SAdownJ + SJdownJ - 1))/((beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) - 1)*(alpha + 1)*(alpha + g0 + 1)*(g0 + beta0*(IAdownJ + IJdownJ*h)*(eps - resJval + 1) + 1)) + (a0*beta0*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*(IAupJ + IJupJ*h)*((c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) - 1)*((alpha + 1)*(alpha + g0 + 1) + beta0*f*(beta0*(IAupJ + IJupJ*h)*(resAval - 1) - 1)*(IAupJ + IJupJ*h)*(eps + resJval - 1) - beta0*f*(IAupJ + IJupJ*h)*(resAval - 1)*(alpha + g0 + 1))*(IAupJ + IJupJ + SAupJ + SJupJ - 1))/((beta0*(IAupJ + IJupJ*h)*(resAval - 1) - 1)^2*(alpha + 1)*(alpha + g0 + 1)*(g0 - beta0*(IAupJ + IJupJ*h)*(eps + resJval - 1) + 1)) + (a0*beta0*g0*((c1a*(exp(-c2a*resAval) - 1))/(exp(-c2a) - 1) - 1)*((c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) - 1)*(IAdownJ + IJdownJ*h)*(beta0*f*(beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) - 1)*(IAdownJ + IJdownJ*h)*(eps - resJval + 1) - (alpha + 1)*(alpha + g0 + 1) + beta0*f*(IAdownJ + IJdownJ*h)*(resAval - 1)*(alpha + g0 + 1))*(IAdownJ + IJdownJ + SAdownJ + SJdownJ - 1))/((beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) - 1)^2*(alpha + 1)*(alpha + g0 + 1)*(g0 + beta0*(IAdownJ + IJdownJ*h)*(eps - resJval + 1) + 1)) + (a0*c1a*c2a*g0*exp(-c2a*resAval)*((c1g*(exp(-c2g*(eps + resJval)) - 1))/(exp(-c2g) - 1) - 1)*((alpha + 1)*(alpha + g0 + 1) + beta0*f*(beta0*(IAupJ + IJupJ*h)*(resAval - 1) - 1)*(IAupJ + IJupJ*h)*(eps + resJval - 1) - beta0*f*(IAupJ + IJupJ*h)*(resAval - 1)*(alpha + g0 + 1))*(IAupJ + IJupJ + SAupJ + SJupJ - 1))/((exp(-c2a) - 1)*(beta0*(IAupJ + IJupJ*h)*(resAval - 1) - 1)*(alpha + 1)*(alpha + g0 + 1)*(g0 - beta0*(IAupJ + IJupJ*h)*(eps + resJval - 1) + 1)) + (a0*c1a*c2a*g0*exp(-c2a*resAval)*((c1g*(exp(c2g*(eps - resJval)) - 1))/(exp(-c2g) - 1) - 1)*(beta0*f*(beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) - 1)*(IAdownJ + IJdownJ*h)*(eps - resJval + 1) - (alpha + 1)*(alpha + g0 + 1) + beta0*f*(IAdownJ + IJdownJ*h)*(resAval - 1)*(alpha + g0 + 1))*(IAdownJ + IJdownJ + SAdownJ + SJdownJ - 1))/((exp(-c2a) - 1)*(beta0*(IAdownJ + IJdownJ*h)*(resAval - 1) - 1)*(alpha + 1)*(alpha + g0 + 1)*(g0 + beta0*(IAdownJ + IJdownJ*h)*(eps - resJval + 1) + 1)))/(2*eps);
    
end

% Set up the conditions for strong convergence stability. For the
% co-singular strategy to be strong convergence stable, we need the first
% condition to be positive and the others to be negative:
convstab1=(deriv2J+cderivJ1)*(deriv2A+cderivA1)-cderivJ2*cderivA2;
convstab2=deriv2J+cderivJ1;
convstab3=deriv2A+cderivA1;

% Here are the overall conditions for evolutionary and strong convergence
% stability:
conv_condition=convstab1>0 && convstab2<0 && convstab3<0;
evo_condition=deriv2J<0 && deriv2A<0;

% It is possible for a co-singular strategy to be evolutionarily stable in
% one trait but not the other. We have not observed this to happen in this
% system, but if it does happen then this message will appear:
if (deriv2J<0 && deriv2A>0) || (deriv2J>0 && deriv2A<0)
    disp("Different juvenile and adult stability in version=" +version +"and at beta0=" +beta0)
    disp("deriv2J=" +deriv2J)
    disp("deriv2A=" +deriv2A)
    disp("resJval=" +resJval)
    disp("resAval=" +resAval)
end

% Define outputs:
if conv_condition && evo_condition
    classJ=1;
    classA=1;
elseif ~conv_condition && ~evo_condition
    classJ=2;
    classA=2;
elseif conv_condition && ~evo_condition
    classJ=3;
    classA=3;
    disp("BRANCHING POINT in version=" +version)
elseif ~conv_condition && evo_condition % This is technically a 'Garden of Eden' singular strategy but to almost all intents and purposes it behaves like a repeller.
    classJ=2;
    classA=2;
end


end

